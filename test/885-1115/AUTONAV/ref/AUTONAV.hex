10 :REM  AUTONAV.BAS\tAutomatic Route Selection Program     08-Jan-82
E0 73 0A 00 3A 8F DB 20 41 55 54 4F 4E 41 56 2E 42 41 53 09 41 75 74 6F 6D 61 74 69 63 20 52 6F 75 74 65 20 53 65 6C 65 63 74 69 6F 6E 20 50 72 6F 67 72 61 6D 20 20 20 20 20 30 38 2D 4A 61 6E 2D 38 32 00

20 :REM  by Alan Bose
F5 73 14 00 3A 8F DB 20 62 79 20 41 6C 61 6E 20 42 6F 73 65 00

30 CLEAR2000:WIDTH255
02 74 1E 00 92 1C D0 07 3A A1 0F FF 00

40 BL$=CHR$(0x18):E$=CHR$(27):ER$=E$+"E":PG$=E$+"p":QG$=E$+"q":Y$=E$+"Y":L$=E$+"K":J$=E$+"j":K$=E$+"k":J1$=E$+"J":U=[1F]164F3DD2STEP.eDIM
7A 74 28 00 42 4C 24 F0 FF 96 28 18 29 3A 45 24 F0 FF 96 28 0F 1B 29 3A 45 52 24 F0 45 24 F2 22 45 22 3A 50 47 24 F0 45 24 F2 22 70 22 3A 51 47 24 F0 45 24 F2 22 71 22 3A 59 24 F0 45 24 F2 22 59 22 3A 4C 24 F0 45 24 F2 22 4B 22 3A 4A 24 F0 45 24 F2 22 6A 22 3A 4B 24 F0 45 24 F2 22 6B 22 3A 4A 31 24 F0 45 24 F2 22 4A 22 3A 55 F0 1F 16 4F 3D D2 E0 2E 65 86 00

50 DEFFNC$(C1,C2)=Y$+CHR$(C1+31)+CHR$(C2+31):H$=FNC$(0x13,0x12)
AD 74 32 00 98 D3 43 24 28 43 31 2C 43 32 29 F0 59 24 F2 FF 96 28 43 31 F2 0F 1F 29 F2 FF 96 28 43 32 F2 0F 1F 29 3A 48 24 F0 D3 43 24 28 13 2C 12 29 00

60 DEFFNS6(X)=INT(X*10+[1D]00000080)/10
CB 74 3C 00 98 D3 53 36 28 58 29 F0 FF 85 28 58 F4 0F 0A F2 1D 00 00 00 80 29 F5 0F 0A 00

70 DEFFNS7(X)=ATN(X/SQR(0x12-X*X))*U
E9 74 46 00 98 D3 53 37 28 58 29 F0 FF 8E 28 58 F5 FF 87 28 12 F3 58 F4 58 29 29 F4 55 00

80 DEFFNS8(X)=SIN(ABS(A/0x13)/U)*COS(X/U)/SIN(Q2/0x13)
14 75 50 00 98 D3 53 38 28 58 29 F0 FF 89 28 FF 86 28 41 F5 13 29 F5 55 29 F4 FF 8C 28 58 F5 55 29 F5 FF 89 28 51 32 F5 13 29 00

90 FOR I=8383 TO 8391:DT$=DT$+CHR$(PEEK(I)):NEXT I
3C 75 5A 00 82 20 49 F0 1C BF 20 20 CE 20 1C C7 20 3A 44 54 24 F0 44 54 24 F2 FF 96 28 FF 97 28 49 29 29 3A 83 20 49 00

100 PRINTFNC$(25,0x12);ER$;E$+"H";ER$;"Standby one..."
6B 75 64 00 91 D3 43 24 28 0F 19 2C 12 29 3B 45 52 24 3B 45 24 F2 22 48 22 3B 45 52 24 3B 22 53 74 61 6E 64 62 79 20 6F 6E 65 2E 2E 2E 22 00

110 :REM 
73 75 6E 00 3A 8F DB 00

120 OPEN"R",0x12,"SY1:AIRPORTS.RND"
91 75 78 00 BF 22 52 22 2C 12 2C 22 53 59 31 3A 41 49 52 50 4F 52 54 53 2E 52 4E 44 22 00

130 MD=LOC(0x12)*0x16
A0 75 82 00 4D 44 F0 FF B0 28 12 29 F4 16 00

140 DIM ID$(MD),FA$(MD),LT(MD),LN(MD),PR(MD),W(20),D(20),H(20)
DD 75 8C 00 86 20 49 44 24 28 4D 44 29 2C 46 41 24 28 4D 44 29 2C 4C 54 28 4D 44 29 2C 4C 4E 28 4D 44 29 2C 50 52 28 4D 44 29 2C 57 28 0F 14 29 2C 44 28 0F 14 29 2C 48 28 0F 14 29 00

150 FOR J=0x12 TO MD:REC=((J-0x12)MOD0x16)+0x12:SS=(J-0x12) [FC] 0x16
09 76 96 00 82 20 4A F0 12 20 CE 20 4D 44 3A 52 45 43 F0 28 28 4A F3 12 29 FD 16 29 F2 12 3A 53 53 F0 28 4A F3 12 29 20 FC 20 16 00

160 IF [0xFF][AF](0x12)<>REC THEN GET#0x12,REC
24 76 A0 00 8B 20 FF AF 28 12 29 F1 EF 52 45 43 20 CF 20 C1 23 12 2C 52 45 43 00

170 OPTION#0x12,SS*50 AS DU$,0x16 AS ID$,0x13 AS FAC$,24 AS DU$,0x13 AS D1$,0x15 AS M1$,0x13 AS D$,0x15 AS M$
78 76 AA 00 C0 23 12 2C 53 53 F4 0F 32 20 41 53 20 44 55 24 2C 16 20 41 53 20 49 44 24 2C 13 20 41 53 20 46 41 43 24 2C 0F 18 20 41 53 20 44 55 24 2C 13 20 41 53 20 44 31 24 2C 15 20 41 53 20 4D 31 24 2C 13 20 41 53 20 44 24 2C 15 20 41 53 20 4D 24 00

180 ID$(J)=ID$:FA$(J)=FAC$:D6=[0xFF][AA](D1$):M6=CVI(M1$):D5=[0xFF][AA](D$):M5=CVI(M$)
BD 76 B4 00 49 44 24 28 4A 29 F0 49 44 24 3A 46 41 24 28 4A 29 F0 46 41 43 24 3A 44 36 F0 FF AA 28 44 31 24 29 3A 4D 36 F0 FF AB 28 4D 31 24 29 3A 44 35 F0 FF AA 28 44 24 29 3A 4D 35 F0 FF AB 28 4D 24 29 00

190 IF ASC(ID$(J))=0x11 THEN ID$(J)="     "
E1 76 BE 00 8B 20 FF 95 28 49 44 24 28 4A 29 29 F0 11 20 CF 20 49 44 24 28 4A 29 F0 22 20 20 20 20 20 22 00

200 IF ID$(J)="     " THEN PR(J)=0x14
00 77 C8 00 8B 20 49 44 24 28 4A 29 F0 22 20 20 20 20 20 22 20 CF 20 50 52 28 4A 29 F0 14 00

210 M1=M6/60:LT(J)=D6+M1
19 77 D2 00 4D 31 F0 4D 36 F5 0F 3C 3A 4C 54 28 4A 29 F0 44 36 F2 4D 31 00

220 M=M5/60:LN(J)=D5+M
30 77 DC 00 4D F0 4D 35 F5 0F 3C 3A 4C 4E 28 4A 29 F0 44 35 F2 4D 00

230 NEXT J
38 77 E6 00 83 20 4A 00

240 :REM 
40 77 F0 00 3A 8F DB 00

250 PRINTER$;FNC$(0x12,20);"NAVPROGseven Automatic Route Preparation"
7E 77 FA 00 91 45 52 24 3B D3 43 24 28 12 2C 0F 14 29 3B 22 4E 41 56 50 52 4F 47 73 65 76 65 6E 20 41 75 74 6F 6D 61 74 69 63 20 52 6F 75 74 65 20 50 72 65 70 61 72 61 74 69 6F 6E 22 00

260 PRINTFNC$(0x18,0x12);J1$;"Enter departure point  <MENU>  ";J$;STRING$(0x16,95);K$;:LINE INPUT X$
C8 77 04 01 91 D3 43 24 28 18 2C 12 29 3B 4A 31 24 3B 22 45 6E 74 65 72 20 64 65 70 61 72 74 75 72 65 20 70 6F 69 6E 74 20 20 3C 4D 45 4E 55 3E 20 20 22 3B 4A 24 3B D8 28 16 2C 0F 5F 29 3B 4B 24 3B 3A B1 20 85 20 58 24 00

270 IF X$="" THEN CLOSE:LOAD"MENU",R
E2 77 0E 01 8B 20 58 24 F0 22 22 20 CF 20 C3 3A C4 22 4D 45 4E 55 22 2C 52 00

280 I=0x12:GOSUB1790:GOSUB1310:IF FD=0x11 THEN 260
01 78 18 01 49 F0 12 3A 8D 0E FE 06 3A 8D 0E 1E 05 3A 8B 20 46 44 F0 11 20 CF 20 0E 04 01 00

290 P2=LT(W(0x12)):P1=LN(W(0x12)):PR(PI)=0x13:XT=P2:NT=P2:XN=P1:NN=P1
3E 78 22 01 50 32 F0 4C 54 28 57 28 12 29 29 3A 50 31 F0 4C 4E 28 57 28 12 29 29 3A 50 52 28 50 49 29 F0 13 3A 58 54 F0 50 32 3A 4E 54 F0 50 32 3A 58 4E F0 50 31 3A 4E 4E F0 50 31 00

300 :REM 
46 78 2C 01 3A 8F DB 00

310 PRINTFNC$(0x18,0x12);J1$;"Enter destination  <EXIT>  ";J$;STRING$(0x16,95);K$;:LINE INPUT X$
8C 78 36 01 91 D3 43 24 28 18 2C 12 29 3B 4A 31 24 3B 22 45 6E 74 65 72 20 64 65 73 74 69 6E 61 74 69 6F 6E 20 20 3C 45 58 49 54 3E 20 20 22 3B 4A 24 3B D8 28 16 2C 0F 5F 29 3B 4B 24 3B 3A B1 20 85 20 58 24 00

320 IF X$="" THEN 260
9E 78 40 01 8B 20 58 24 F0 22 22 20 CF 20 0E 04 01 00

330 MC=0x14:I=0x14:GOSUB1790:GOSUB1310:IF FD=0x11 THEN 310
C2 78 4A 01 4D 43 F0 14 3A 49 F0 14 3A 8D 0E FE 06 3A 8D 0E 1E 05 3A 8B 20 46 44 F0 11 20 CF 20 0E 36 01 00

340 P4=LT(W(0x14)):P3=LN(W(0x14)):PR(PI)=0x13
E7 78 54 01 50 34 F0 4C 54 28 57 28 14 29 29 3A 50 33 F0 4C 4E 28 57 28 14 29 29 3A 50 52 28 50 49 29 F0 13 00

350 GOSUB1600:PH=T:TD=C
FA 78 5E 01 8D 0E 40 06 3A 50 48 F0 54 3A 54 44 F0 43 00

360 IF TD<30 THEN PRINTFNC$(0x18,0x12);J1$;"That's a lot of work for a";INT(TD);"mile flight.  Continue? (Y or N) ";:X$=INPUT$(0x12):GOSUB1790:PRINTX$:IF X$="N" THEN 250 :ELSE IF X$<>"Y" THEN PRINTBL$;:GOTO360
9A 79 68 01 8B 20 54 44 F1 0F 1E 20 CF 20 91 D3 43 24 28 18 2C 12 29 3B 4A 31 24 3B 22 54 68 61 74 27 73 20 61 20 6C 6F 74 20 6F 66 20 77 6F 72 6B 20 66 6F 72 20 61 22 3B FF 85 28 54 44 29 3B 22 6D 69 6C 65 20 66 6C 69 67 68 74 2E 20 20 43 6F 6E 74 69 6E 75 65 3F 20 28 59 20 6F 72 20 4E 29 20 22 3B 3A 58 24 F0 85 24 28 12 29 3A 8D 0E FE 06 3A 91 58 24 3A 8B 20 58 24 F0 22 4E 22 20 CF 20 0E FA 00 20 3A A2 20 8B 20 58 24 F1 EF 22 59 22 20 CF 20 91 42 4C 24 3B 3A 89 0E 68 01 00

370 :REM 
A2 79 72 01 3A 8F DB 00

380 PRINTFNC$(0x18,0x12);J1$;"Enter specific checkpoint to overfly, if desired  <CONTINUE> ";J$;STRING$(0x16,95);K$;:LINE INPUT X$
0A 7A 7C 01 91 D3 43 24 28 18 2C 12 29 3B 4A 31 24 3B 22 45 6E 74 65 72 20 73 70 65 63 69 66 69 63 20 63 68 65 63 6B 70 6F 69 6E 74 20 74 6F 20 6F 76 65 72 66 6C 79 2C 20 69 66 20 64 65 73 69 72 65 64 20 20 3C 43 4F 4E 54 49 4E 55 45 3E 20 22 3B 4A 24 3B D8 28 16 2C 0F 5F 29 3B 4B 24 3B 3A B1 20 85 20 58 24 00

390 IF X$="" THEN W(0x13)=W(0x14):W(0x14)=0x11:MC=0x13:NW=0x11:GOTO450
38 7A 86 01 8B 20 58 24 F0 22 22 20 CF 20 57 28 13 29 F0 57 28 14 29 3A 57 28 14 29 F0 11 3A 4D 43 F0 13 3A 4E 57 F0 11 3A 89 0E C2 01 00

400 I=0x13:GOSUB1790:GOSUB1310:IF FD=0x11 THEN 380
57 7A 90 01 49 F0 13 3A 8D 0E FE 06 3A 8D 0E 1E 05 3A 8B 20 46 44 F0 11 20 CF 20 0E 7C 01 00

410 PRINTFNC$(0x18,0x12);BL$;L$;"90 degree course change doubles time needed to calculate."
A8 7A 9A 01 91 D3 43 24 28 18 2C 12 29 3B 42 4C 24 3B 4C 24 3B 22 39 30 20 64 65 67 72 65 65 20 63 6F 75 72 73 65 20 63 68 61 6E 67 65 20 64 6F 75 62 6C 65 73 20 74 69 6D 65 20 6E 65 65 64 65 64 20 74 6F 20 63 61 6C 63 75 6C 61 74 65 2E 22 00

420 P2=LT(W(0x13)):P1=LN(W(0x13)):PR(PI)=0x13:NW=0x12
D2 7A A4 01 50 32 F0 4C 54 28 57 28 13 29 29 3A 50 31 F0 4C 4E 28 57 28 13 29 29 3A 50 52 28 50 49 29 F0 13 3A 4E 57 F0 12 00

430 GOSUB1600:TD=C:DH=ABS(PH-T):IF DH>180 THEN DH=360-DH
00 7B AE 01 8D 0E 40 06 3A 54 44 F0 43 3A 44 48 F0 FF 86 28 50 48 F3 54 29 3A 8B 20 44 48 EF 0F B4 20 CF 20 44 48 F0 1C 68 01 F3 44 48 00

440 P4=LT(W(0x12)):P3=LN(W(0x12)):GOSUB1600:TD=TD+C
29 7B B8 01 50 34 F0 4C 54 28 57 28 12 29 29 3A 50 33 F0 4C 4E 28 57 28 12 29 29 3A 8D 0E 40 06 3A 54 44 F0 54 44 F2 43 00

450 MV=30+DH
36 7B C2 01 4D 56 F0 0F 1E F2 44 48 00

460 I=0x16:PRINTFNC$(0x18,0x12);L$;
4C 7B CC 01 49 F0 16 3A 91 D3 43 24 28 18 2C 12 29 3B 4C 24 3B 00

470 PRINTFNC$(I+0x13,0x12);J1$:PRINT"Enter checkpoint to be disregarded, if desired  <CONTINUE> ";J$;STRING$(0x16,95);K$;:LINE INPUT X$
B5 7B D6 01 91 D3 43 24 28 49 F2 13 2C 12 29 3B 4A 31 24 3A 91 22 45 6E 74 65 72 20 63 68 65 63 6B 70 6F 69 6E 74 20 74 6F 20 62 65 20 64 69 73 72 65 67 61 72 64 65 64 2C 20 69 66 20 64 65 73 69 72 65 64 20 20 3C 43 4F 4E 54 49 4E 55 45 3E 20 22 3B 4A 24 3B D8 28 16 2C 0F 5F 29 3B 4B 24 3B 3A B1 20 85 20 58 24 00

480 IF X$="" THEN 510
C7 7B E0 01 8B 20 58 24 F0 22 22 20 CF 20 0E FE 01 00

490 GOSUB1790:GOSUB1310:IF FD=0x11 THEN 470
E2 7B EA 01 8D 0E FE 06 3A 8D 0E 1E 05 3A 8B 20 46 44 F0 11 20 CF 20 0E D6 01 00

500 I=I+0x12:PR(PI)=0x14:PRINT"  WILL BE IGNORED":GOTO470
0F 7C F4 01 49 F0 49 F2 12 3A 50 52 28 50 49 29 F0 14 3A 91 22 20 20 57 49 4C 4C 20 42 45 20 49 47 4E 4F 52 45 44 22 3A 89 0E D6 01 00

510 PRINTFNC$(I+0x14,0x12);J1$;"Correct? (Y or N) ";:X$=INPUT$(0x12):GOSUB1790:PRINTX$:IF X$="N" THEN 250 :ELSE IF X$<>"Y" THEN PRINTBL$:GOTO510
73 7C FE 01 91 D3 43 24 28 49 F2 14 2C 12 29 3B 4A 31 24 3B 22 43 6F 72 72 65 63 74 3F 20 28 59 20 6F 72 20 4E 29 20 22 3B 3A 58 24 F0 85 24 28 12 29 3A 8D 0E FE 06 3A 91 58 24 3A 8B 20 58 24 F0 22 4E 22 20 CF 20 0E FA 00 20 3A A2 20 8B 20 58 24 F1 EF 22 59 22 20 CF 20 91 42 4C 24 3A 89 0E FE 01 00

520 PRINTFNC$(0x18,0x12);J1$
85 7C 08 02 91 D3 43 24 28 18 2C 12 29 3B 4A 31 24 00

530 :REM 
8D 7C 12 02 3A 8F DB 00

540 FOR J=0x12 TO MC:IF LT(W(J))>XT THEN XT=LT(W(J)):GOTO560
BD 7C 1C 02 82 20 4A F0 12 20 CE 20 4D 43 3A 8B 20 4C 54 28 57 28 4A 29 29 EF 58 54 20 CF 20 58 54 F0 4C 54 28 57 28 4A 29 29 3A 89 0E 30 02 00

550 IF LT(W(J))<NT THEN NT=LT(W(J))
DD 7C 26 02 8B 20 4C 54 28 57 28 4A 29 29 F1 4E 54 20 CF 20 4E 54 F0 4C 54 28 57 28 4A 29 29 00

560 IF LN(W(J))>XN THEN XN=LN(W(J)):GOTO580
02 7D 30 02 8B 20 4C 4E 28 57 28 4A 29 29 EF 58 4E 20 CF 20 58 4E F0 4C 4E 28 57 28 4A 29 29 3A 89 0E 44 02 00

570 IF LN(W(J))<NN THEN NN=LN(W(J))
22 7D 3A 02 8B 20 4C 4E 28 57 28 4A 29 29 F1 4E 4E 20 CF 20 4E 4E F0 4C 4E 28 57 28 4A 29 29 00

580 NEXT J:XT=XT+0x14:NT=NT-0x14:XN=XN+0x14:NN=NN-0x14
4A 7D 44 02 83 20 4A 3A 58 54 F0 58 54 F2 14 3A 4E 54 F0 4E 54 F3 14 3A 58 4E F0 58 4E F2 14 3A 4E 4E F0 4E 4E F3 14 00

590 FOR J=0x12 TO MD:IF LT(J)>XT THEN 640
6A 7D 4E 02 82 20 4A F0 12 20 CE 20 4D 44 3A 8B 20 4C 54 28 4A 29 EF 58 54 20 CF 20 0E 80 02 00

600 IF LT(J)<NT THEN 640
7F 7D 58 02 8B 20 4C 54 28 4A 29 F1 4E 54 20 CF 20 0E 80 02 00

610 IF LN(J)>XN THEN 640
94 7D 62 02 8B 20 4C 4E 28 4A 29 EF 58 4E 20 CF 20 0E 80 02 00

620 IF LN(J)<NN THEN 640
A9 7D 6C 02 8B 20 4C 4E 28 4A 29 F1 4E 4E 20 CF 20 0E 80 02 00

630 GOTO650
B2 7D 76 02 89 0E 8A 02 00

640 PR(J)=0x14
BE 7D 80 02 50 52 28 4A 29 F0 14 00

650 NEXT J
C6 7D 8A 02 83 20 4A 00

660 CLOSE:GOSUB1600
D1 7D 94 02 C3 3A 8D 0E 40 06 00

670 ML=INT(TD*[1D]00000080)
E5 7D 9E 02 4D 4C F0 FF 85 28 54 44 F4 1D 00 00 00 80 29 00

680 IF ML<30 THEN ML=30
F9 7D A8 02 8B 20 4D 4C F1 0F 1E 20 CF 20 4D 4C F0 0F 1E 00

690 OPEN"O",0x13,"LP:"
0A 7E B2 02 BF 22 4F 22 2C 13 2C 22 4C 50 3A 22 00

700 PRINT#0x13,"NAVPROGseven Automatic Route Preparation";TAB(60);DT$
46 7E BC 02 91 23 13 2C 22 4E 41 56 50 52 4F 47 73 65 76 65 6E 20 41 75 74 6F 6D 61 74 69 63 20 52 6F 75 74 65 20 50 72 65 70 61 72 61 74 69 6F 6E 22 3B D0 0F 3C 29 3B 44 54 24 00

710 PRINT#0x13,:PRINT#0x13,:PRINT#0x13,"Depart: ";ID$(W(0x12));"    Dest: ";ID$(W(MC))
85 7E C6 02 91 23 13 2C 3A 91 23 13 2C 3A 91 23 13 2C 22 44 65 70 61 72 74 3A 20 22 3B 49 44 24 28 57 28 12 29 29 3B 22 20 20 20 20 44 65 73 74 3A 20 22 3B 49 44 24 28 57 28 4D 43 29 29 00

720 PRINT#0x13,"Great circle dist: ";TD;"nm":PRINT#0x13,
B0 7E D0 02 91 23 13 2C 22 47 72 65 61 74 20 63 69 72 63 6C 65 20 64 69 73 74 3A 20 22 3B 54 44 3B 22 6E 6D 22 3A 91 23 13 2C 00

730 PRINT#0x13,TAB(16);"nm";TAB(25);"TC"
CC 7E DA 02 91 23 13 2C D0 0F 10 29 3B 22 6E 6D 22 3B D0 0F 19 29 3B 22 54 43 22 00

740 PRINTH$;J1$
D8 7E E4 02 91 48 24 3B 4A 31 24 00

750 PRINT"Depart: ";ID$(W(0x12));"    Dest: ";ID$(W(MC))
0A 7F EE 02 91 22 44 65 70 61 72 74 3A 20 22 3B 49 44 24 28 57 28 12 29 29 3B 22 20 20 20 20 44 65 73 74 3A 20 22 3B 49 44 24 28 57 28 4D 43 29 29 00

760 PRINT"Great circle dist: ";TD;"nm"
2D 7F F8 02 91 22 47 72 65 61 74 20 63 69 72 63 6C 65 20 64 69 73 74 3A 20 22 3B 54 44 3B 22 6E 6D 22 00

770 PRINT"Test Segment:";ML;"nm"
4A 7F 02 03 91 22 54 65 73 74 20 53 65 67 6D 65 6E 74 3A 22 3B 4D 4C 3B 22 6E 6D 22 00

780 FOR J=0x11 TO MD:IF PR(J)=0x12 THEN PR(J)=0x11:NEXT J :ELSE NEXT J
78 7F 0C 03 82 20 4A F0 11 20 CE 20 4D 44 3A 8B 20 50 52 28 4A 29 F0 12 20 CF 20 50 52 28 4A 29 F0 11 3A 83 20 4A 20 3A A2 20 83 20 4A 00

790 :REM 
80 7F 16 03 3A 8F DB 00

800 CY=0x12:NE=0x11:FOR J=0x12 TO MC:PRINTFNC$(0x17+J,0x12);J;FNC$(0x17+J,0x16);ID$(W(J));" ";FA$(W(J)):NEXT J
CE 7F 20 03 43 59 F0 12 3A 4E 45 F0 11 3A 82 20 4A F0 12 20 CE 20 4D 43 3A 91 D3 43 24 28 17 F2 4A 2C 12 29 3B 4A 3B D3 43 24 28 17 F2 4A 2C 16 29 3B 49 44 24 28 57 28 4A 29 29 3B 22 20 22 3B 46 41 24 28 57 28 4A 29 29 3A 83 20 4A 00

810 P2=LT(W(CY)):P1=LN(W(CY)):P4=LT(W(CY+0x12)):P3=LN(W(CY+0x12)):IF PR(W(CY))=0x11 THEN PR(W(CY))=0x12
26 80 2A 03 50 32 F0 4C 54 28 57 28 43 59 29 29 3A 50 31 F0 4C 4E 28 57 28 43 59 29 29 3A 50 34 F0 4C 54 28 57 28 43 59 F2 12 29 29 3A 50 33 F0 4C 4E 28 57 28 43 59 F2 12 29 29 3A 8B 20 50 52 28 57 28 43 59 29 29 F0 11 20 CF 20 50 52 28 57 28 43 59 29 29 F0 12 00

820 PRINTFNC$(0x17+CY,0x12);PG$;CY;QG$
42 80 34 03 91 D3 43 24 28 17 F2 43 59 2C 12 29 3B 50 47 24 3B 43 59 3B 51 47 24 00

830 GOSUB1600:PH=T:SH=T:PD=C:BD=C
5F 80 3E 03 8D 0E 40 06 3A 50 48 F0 54 3A 53 48 F0 54 3A 50 44 F0 43 3A 42 44 F0 43 00

840 BH=360:BP=0x11:DD=0x13*C
76 80 48 03 42 48 F0 1C 68 01 3A 42 50 F0 11 3A 44 44 F0 13 F4 43 00

850 IF C<ML THEN D(CY)=BD:H(CY)=INT(SH):GOTO1120
9E 80 52 03 8B 20 43 F1 4D 4C 20 CF 20 44 28 43 59 29 F0 42 44 3A 48 28 43 59 29 F0 FF 85 28 53 48 29 3A 89 0E 60 04 00

860 :REM 
A6 80 5C 03 3A 8F DB 00

870 FOR J=0x12 TO MD
B5 80 66 03 82 20 4A F0 12 20 CE 20 4D 44 00

880 PRINTFNC$(0x12,0x12);ID$(J)
CA 80 70 03 91 D3 43 24 28 12 2C 12 29 3B 49 44 24 28 4A 29 00

890 IF PR(J)>0x11 THEN 1090
DE 80 7A 03 8B 20 50 52 28 4A 29 EF 11 20 CF 20 0E 42 04 00

900 P4=LT(J):P3=LN(J)
F4 80 84 03 50 34 F0 4C 54 28 4A 29 3A 50 33 F0 4C 4E 28 4A 29 00

910 IF P1=P3 AND P2=P4 THEN 1090
0E 81 8E 03 8B 20 50 31 F0 50 33 20 F7 20 50 32 F0 50 34 20 CF 20 0E 42 04 00

920 GOSUB1600:IF C>TD THEN PR(J)=0x14:GOTO 1090
2E 81 98 03 8D 0E 40 06 3A 8B 20 43 EF 54 44 20 CF 20 50 52 28 4A 29 F0 14 3A 89 20 0E 42 04 00

930 IF C>PD OR (ML>60 AND C>PD*[1D]C2F52880) THEN 1090
56 81 A2 03 8B 20 43 EF 50 44 20 F8 20 28 4D 4C EF 0F 3C 20 F7 20 43 EF 50 44 F4 1D C2 F5 28 80 29 20 CF 20 0E 42 04 00

940 C1=C:T1=T:RD=C:DH=ABS(PH-T)
75 81 AC 03 43 31 F0 43 3A 54 31 F0 54 3A 52 44 F0 43 3A 44 48 F0 FF 86 28 50 48 F3 54 29 00

950 IF DH>180 THEN DH=360-DH
8D 81 B6 03 8B 20 44 48 EF 0F B4 20 CF 20 44 48 F0 1C 68 01 F3 44 48 00

960 IF DH<=30 THEN 1000
A0 81 C0 03 8B 20 44 48 F1 F0 0F 1E 20 CF 20 0E E8 03 00

970 IF DH<=MV THEN 1090
B3 81 CA 03 8B 20 44 48 F1 F0 4D 56 20 CF 20 0E 42 04 00

980 IF CY=0x12 OR DH<=90 THEN PR(J)=0x14:GOTO1090
D6 81 D4 03 8B 20 43 59 F0 12 20 F8 20 44 48 F1 F0 0F 5A 20 CF 20 50 52 28 4A 29 F0 14 3A 89 0E 42 04 00

990 PR(J)=0x12:GOTO1090
E7 81 DE 03 50 52 28 4A 29 F0 12 3A 89 0E 42 04 00

1000 P2=P4:P1=P3:P4=LT(W(CY+0x12)):P3=LN(W(CY+0x12))
15 82 E8 03 50 32 F0 50 34 3A 50 31 F0 50 33 3A 50 34 F0 4C 54 28 57 28 43 59 F2 12 29 29 3A 50 33 F0 4C 4E 28 57 28 43 59 F2 12 29 29 00

1010 GOSUB1600:T2=T:C2=C:RD=RD+C:P2=LT(W(CY)):P1=LN(W(CY))
4A 82 F2 03 8D 0E 40 06 3A 54 32 F0 54 3A 43 32 F0 43 3A 52 44 F0 52 44 F2 43 3A 50 32 F0 4C 54 28 57 28 43 59 29 29 3A 50 31 F0 4C 4E 28 57 28 43 59 29 29 00

1020 IF RD>DD THEN 1090
5C 82 FC 03 8B 20 52 44 EF 44 44 20 CF 20 0E 42 04 00

1030 DH=ABS(PH-T):IF DH>180 THEN DH=360-DH
80 82 06 04 44 48 F0 FF 86 28 50 48 F3 54 29 3A 8B 20 44 48 EF 0F B4 20 CF 20 44 48 F0 1C 68 01 F3 44 48 00

1040 IF DH<30 THEN 1070
92 82 10 04 8B 20 44 48 F1 0F 1E 20 CF 20 0E 2E 04 00

1050 IF ML<30 AND CY+0x12=MC AND DH<45 AND C<14 THEN 1070
BD 82 1A 04 8B 20 4D 4C F1 0F 1E 20 F7 20 43 59 F2 12 F0 4D 43 20 F7 20 44 48 F1 0F 2D 20 F7 20 43 F1 0F 0E 20 CF 20 0E 2E 04 00

1060 IF ML>=30 OR CY+0x12<>MC OR DH>60 OR C>0x18 THEN 1090
E9 82 24 04 8B 20 4D 4C EF F0 0F 1E 20 F8 20 43 59 F2 12 F1 EF 4D 43 20 F8 20 44 48 EF 0F 3C 20 F8 20 43 EF 18 20 CF 20 0E 42 04 00

1070 BP=J:DD=RD:NE=0x12
FD 82 2E 04 42 50 F0 4A 3A 44 44 F0 52 44 3A 4E 45 F0 12 00

1080 SH=T1:BD=C1:S2=T2:B2=C2::BP$=ID$(BP):PRINTFNC$(0x18+CY,0x12);CY+0x12;FNC$(0x18+CY,0x16);PG$;BP$;QG$;" ";FA$(BP):FOR K=CY+0x12 TO MC:PRINTFNC$(0x18+K,0x12);K+0x12;FNC$(0x18+K,0x16)ID$(W(K));" ";FA$(W(K)):NEXT K
A0 83 38 04 53 48 F0 54 31 3A 42 44 F0 43 31 3A 53 32 F0 54 32 3A 42 32 F0 43 32 3A 3A 42 50 24 F0 49 44 24 28 42 50 29 3A 91 D3 43 24 28 18 F2 43 59 2C 12 29 3B 43 59 F2 12 3B D3 43 24 28 18 F2 43 59 2C 16 29 3B 50 47 24 3B 42 50 24 3B 51 47 24 3B 22 20 22 3B 46 41 24 28 42 50 29 3A 82 20 4B F0 43 59 F2 12 20 CE 20 4D 43 3A 91 D3 43 24 28 18 F2 4B 2C 12 29 3B 4B F2 12 3B D3 43 24 28 18 F2 4B 2C 16 29 49 44 24 28 57 28 4B 29 29 3B 22 20 22 3B 46 41 24 28 57 28 4B 29 29 3A 83 20 4B 00

1090 NEXT J:PRINTFNC$(0x12,0x12);SPACE$(0x1A)
B8 83 42 04 83 20 4A 3A 91 D3 43 24 28 12 2C 12 29 3B FF 98 28 1A 29 00

1100 :REM 
C0 83 4C 04 3A 8F DB 00

1110 IF BP>0x11 THEN FOR J=MC TO CY+0x12 STEP -0x12:W(J+0x12)=W(J):D(J+0x12)=D(J):H(J+0x12)=H(J):NEXT J:W(CY+0x12)=BP:PR(BP)=0x13:D(CY)=BD:D(CY+0x12)=B2:H(CY)=INT(SH):H(CY+0x12)=INT(S2):MC=MC+0x12:GOTO1130
59 84 56 04 8B 20 42 50 EF 11 20 CF 20 82 20 4A F0 4D 43 20 CE 20 43 59 F2 12 20 D1 20 F3 12 3A 57 28 4A F2 12 29 F0 57 28 4A 29 3A 44 28 4A F2 12 29 F0 44 28 4A 29 3A 48 28 4A F2 12 29 F0 48 28 4A 29 3A 83 20 4A 3A 57 28 43 59 F2 12 29 F0 42 50 3A 50 52 28 42 50 29 F0 13 3A 44 28 43 59 29 F0 42 44 3A 44 28 43 59 F2 12 29 F0 42 32 3A 48 28 43 59 29 F0 FF 85 28 53 48 29 3A 48 28 43 59 F2 12 29 F0 FF 85 28 53 32 29 3A 4D 43 F0 4D 43 F2 12 3A 89 0E 6A 04 00

1120 IF BP=0x11 THEN D(CY)=BD:H(CY)=INT(SH):GOTO1140
81 84 60 04 8B 20 42 50 F0 11 20 CF 20 44 28 43 59 29 F0 42 44 3A 48 28 43 59 29 F0 FF 85 28 53 48 29 3A 89 0E 74 04 00

1130 P2=LT(BP):P1=LN(BP)
99 84 6A 04 50 32 F0 4C 54 28 42 50 29 3A 50 31 F0 4C 4E 28 42 50 29 00

1140 PRINTFNC$(0x17+CY,0x12);CY
AD 84 74 04 91 D3 43 24 28 17 F2 43 59 2C 12 29 3B 43 59 00

1150 IF BP>0x11 THEN CY=CY+0x13 :ELSE CY=CY+0x12:GOTO1190
D2 84 7E 04 8B 20 42 50 EF 11 20 CF 20 43 59 F0 43 59 F2 13 20 3A A2 20 43 59 F0 43 59 F2 12 3A 89 0E A6 04 00

1160 IF BD<ML*[1D]C2F5287F THEN CY=CY-0x12
EE 84 88 04 8B 20 42 44 F1 4D 4C F4 1D C2 F5 28 7F 20 CF 20 43 59 F0 43 59 F3 12 00

1170 IF B2<ML*[1D]C2F5287F THEN CY=CY-0x13
0A 85 92 04 8B 20 42 32 F1 4D 4C F4 1D C2 F5 28 7F 20 CF 20 43 59 F0 43 59 F3 13 00

1180 IF BP>0x11 THEN FOR J=0x12 TO MC:PRINTFNC$(0x17+J,0x12);J;FNC$(0x17+J,0x16);ID$(W(J));" ";FA$(W(J)):NEXT J
57 85 9C 04 8B 20 42 50 EF 11 20 CF 20 82 20 4A F0 12 20 CE 20 4D 43 3A 91 D3 43 24 28 17 F2 4A 2C 12 29 3B 4A 3B D3 43 24 28 17 F2 4A 2C 16 29 3B 49 44 24 28 57 28 4A 29 29 3B 22 20 22 3B 46 41 24 28 57 28 4A 29 29 3A 83 20 4A 00

1190 IF CY<MC THEN 810
69 85 A6 04 8B 20 43 59 F1 4D 43 20 CF 20 0E 2A 03 00

1200 IF NE=0x11 AND NW>0x14 AND ML>60 THEN 1280
89 85 B0 04 8B 20 4E 45 F0 11 20 F7 20 4E 57 EF 14 20 F7 20 4D 4C EF 0F 3C 20 CF 20 0E 00 05 00

1210 IF NE=0x11 AND NW>0x12 THEN 1260
A1 85 BA 04 8B 20 4E 45 F0 11 20 F7 20 4E 57 EF 12 20 CF 20 0E EC 04 00

1220 TM=0x11:PRINT#0x13,:PRINT#0x13,:FOR J=0x12 TO MC:PRINT#0x13,J;TAB(0x16);ID$(W(J));" ";FA$(W(J));:IF J=MC THEN 1240 :ELSE PRINT#0x13,TAB(14);USING"####.#";D(J);
0B 86 C4 04 54 4D F0 11 3A 91 23 13 2C 3A 91 23 13 2C 3A 82 20 4A F0 12 20 CE 20 4D 43 3A 91 23 13 2C 4A 3B D0 16 29 3B 49 44 24 28 57 28 4A 29 29 3B 22 20 22 3B 46 41 24 28 57 28 4A 29 29 3B 3A 8B 20 4A F0 4D 43 20 CF 20 0E D8 04 20 3A A2 20 91 23 13 2C D0 0F 0E 29 3B D9 22 23 23 23 23 2E 23 22 3B 44 28 4A 29 3B 00

1230 PRINT#0x13,TAB(24);USING"###";H(J)
24 86 CE 04 91 23 13 2C D0 0F 18 29 3B D9 22 23 23 23 22 3B 48 28 4A 29 00

1240 TM=TM+D(J):NEXT J:PRINT#0x13,:PRINT#0x13,TAB(14);STRING$(0x17,45):PRINT #0x13,TAB(14);USING"####.#";TM
64 86 D8 04 54 4D F0 54 4D F2 44 28 4A 29 3A 83 20 4A 3A 91 23 13 2C 3A 91 23 13 2C D0 0F 0E 29 3B D8 28 17 2C 0F 2D 29 3A 91 20 23 13 2C D0 0F 0E 29 3B D9 22 23 23 23 23 2E 23 22 3B 54 4D 00

1250 IF MC>10 THEN PRINT#0x13,"Select up to 10 checkpoints for navigation"
A3 86 E2 04 8B 20 4D 43 EF 0F 0A 20 CF 20 91 23 13 2C 22 53 65 6C 65 63 74 20 75 70 20 74 6F 20 31 30 20 63 68 65 63 6B 70 6F 69 6E 74 73 20 66 6F 72 20 6E 61 76 69 67 61 74 69 6F 6E 22 00

1260 ML=INT(ML*[1D]00000080)
B7 86 EC 04 4D 4C F0 FF 85 28 4D 4C F4 1D 00 00 00 80 29 00

1270 IF ML>=0x16 THEN GOSUB1860:IF MD>MC THEN 740
D8 86 F6 04 8B 20 4D 4C EF F0 16 20 CF 20 8D 0E 44 07 3A 8B 20 4D 44 EF 4D 43 20 CF 20 0E E4 02 00

1280 CLOSE:PRINTFNC$(0x14,0x12);J1$;"Return to menu? (Y or N) ";:X$=INPUT$(0x12):GOSUB1790:PRINTX$:IF X$="Y" THEN LOAD"MENU",R
30 87 00 05 C3 3A 91 D3 43 24 28 14 2C 12 29 3B 4A 31 24 3B 22 52 65 74 75 72 6E 20 74 6F 20 6D 65 6E 75 3F 20 28 59 20 6F 72 20 4E 29 20 22 3B 3A 58 24 F0 85 24 28 12 29 3A 8D 0E FE 06 3A 91 58 24 3A 8B 20 58 24 F0 22 59 22 20 CF 20 C4 22 4D 45 4E 55 22 2C 52 00

1290 IF X$="N" THEN 10 :ELSE PRINTBL$:GOTO1280
50 87 0A 05 8B 20 58 24 F0 22 4E 22 20 CF 20 0E 0A 00 20 3A A2 20 91 42 4C 24 3A 89 0E 00 05 00

1300 :REM 
58 87 14 05 3A 8F DB 00

1310 :REM search index for match & get
7C 87 1E 05 3A 8F DB 73 65 61 72 63 68 20 69 6E 64 65 78 20 66 6F 72 20 6D 61 74 63 68 20 26 20 67 65 74 00

1320 P$=X$+SPACE$(0x16-LEN(X$))
93 87 28 05 50 24 F0 58 24 F2 FF 98 28 16 F3 FF 92 28 58 24 29 29 00

1330 RO=I+0x13
9E 87 32 05 52 4F F0 49 F2 13 00

1340 FD=0x11
A7 87 3C 05 46 44 F0 11 00

1350 FOR J=0x12 TO MD
B6 87 46 05 82 20 4A F0 12 20 CE 20 4D 44 00

1360 IF ID$(J)<>P$ THEN 1410
CD 87 50 05 8B 20 49 44 24 28 4A 29 F1 EF 50 24 20 CF 20 0E 82 05 00

1370 IF FD=0x12 THEN RO=15:GET#0x12,REC:PRINTFNC$(15,0x12);J1$:GOSUB1540:RO=16:FD=0x13
07 88 5A 05 8B 20 46 44 F0 12 20 CF 20 52 4F F0 0F 0F 3A C1 23 12 2C 52 45 43 3A 91 D3 43 24 28 0F 0F 2C 12 29 3B 4A 31 24 3A 8D 0E 04 06 3A 52 4F F0 0F 10 3A 46 44 F0 13 00

1380 PI=J
10 88 64 05 50 49 F0 4A 00

1390 IF FD>0x12 THEN REC=((J-0x12)MOD0x16)+0x12:SS=(J-0x12) [FC] 0x16:GET#0x12,REC:GOSUB1540:FD=FD+0x12:RO=RO+0x12
57 88 6E 05 8B 20 46 44 EF 12 20 CF 20 52 45 43 F0 28 28 4A F3 12 29 FD 16 29 F2 12 3A 53 53 F0 28 4A F3 12 29 20 FC 20 16 3A C1 23 12 2C 52 45 43 3A 8D 0E 04 06 3A 46 44 F0 46 44 F2 12 3A 52 4F F0 52 4F F2 12 00

1400 IF FD=0x11 THEN FD=0x12:REC=((J-0x12)MOD0x16)+0x12:SS=(J-0x12) [FC] 0x16:GET#0x12,REC
8E 88 78 05 8B 20 46 44 F0 11 20 CF 20 46 44 F0 12 3A 52 45 43 F0 28 28 4A F3 12 29 FD 16 29 F2 12 3A 53 53 F0 28 4A F3 12 29 20 FC 20 16 3A C1 23 12 2C 52 45 43 00

1410 NEXT J
96 88 82 05 83 20 4A 00

1420 IF FD=0x11 THEN PRINTBL$;"Can't find ";P$:PRINT"Return to menu and input data? (Y or N) ";:X$=INPUT$(0x12):GOSUB1790:PRINTX$:IF X$="Y" THEN CLOSE:LOAD"MENU",R :ELSE 1520
16 89 8C 05 8B 20 46 44 F0 11 20 CF 20 91 42 4C 24 3B 22 43 61 6E 27 74 20 66 69 6E 64 20 22 3B 50 24 3A 91 22 52 65 74 75 72 6E 20 74 6F 20 6D 65 6E 75 20 61 6E 64 20 69 6E 70 75 74 20 64 61 74 61 3F 20 28 59 20 6F 72 20 4E 29 20 22 3B 3A 58 24 F0 85 24 28 12 29 3A 8D 0E FE 06 3A 91 58 24 3A 8B 20 58 24 F0 22 59 22 20 CF 20 C3 3A C4 22 4D 45 4E 55 22 2C 52 20 3A A2 20 0E F0 05 00

1430 IF FD=0x12 THEN 1490
27 89 96 05 8B 20 46 44 F0 12 20 CF 20 0E D2 05 00

1440 PRINTFNC$(RO+0x12,0x12);"Enter number of your choice <";PI;"> ";J$;STRING$(0x14,95);K$;:LINE INPUT X$
76 89 A0 05 91 D3 43 24 28 52 4F F2 12 2C 12 29 3B 22 45 6E 74 65 72 20 6E 75 6D 62 65 72 20 6F 66 20 79 6F 75 72 20 63 68 6F 69 63 65 20 3C 22 3B 50 49 3B 22 3E 20 22 3B 4A 24 3B D8 28 14 2C 0F 5F 29 3B 4B 24 3B 3A B1 20 85 20 58 24 00

1450 IF X$="" THEN 1490
88 89 AA 05 8B 20 58 24 F0 22 22 20 CF 20 0E D2 05 00

1460 PI=VAL(X$)
96 89 B4 05 50 49 F0 FF 94 28 58 24 29 00

1470 REC=((PI-0x12)MOD0x16)+0x12:SS=(PI-0x12) [FC] 0x16
B9 89 BE 05 52 45 43 F0 28 28 50 49 F3 12 29 FD 16 29 F2 12 3A 53 53 F0 28 50 49 F3 12 29 20 FC 20 16 00

1480 GET#0x12,REC
C5 89 C8 05 C1 23 12 2C 52 45 43 00

1490 PRINTFNC$(15,0x12);J1$
D8 89 D2 05 91 D3 43 24 28 0F 0F 2C 12 29 3B 4A 31 24 00

1500 RO=I+0x13:GOSUB1540
E8 89 DC 05 52 4F F0 49 F2 13 3A 8D 0E 04 06 00

1510 IF I<0x15 THEN W(I)=PI
FC 89 E6 05 8B 20 49 F1 15 20 CF 20 57 28 49 29 F0 50 49 00

1520 RETURN
02 8A F0 05 8E 00

1530 :REM 
0A 8A FA 05 3A 8F DB 00

1540 :REM decode & display
22 8A 04 06 3A 8F DB 64 65 63 6F 64 65 20 26 20 64 69 73 70 6C 61 79 00

1550 OPTION#0x12,SS*50 AS DU$,0x16 AS ID$,0x13 AS FAC$,0x15 AS DU$,20 AS NM$
5D 8A 0E 06 C0 23 12 2C 53 53 F4 0F 32 20 41 53 20 44 55 24 2C 16 20 41 53 20 49 44 24 2C 13 20 41 53 20 46 41 43 24 2C 15 20 41 53 20 44 55 24 2C 0F 14 20 41 53 20 4E 4D 24 00

1560 PRINTFNC$(RO,0x12);L$;:IF RO>14 THEN PRINT PI;
80 8A 18 06 91 D3 43 24 28 52 4F 2C 12 29 3B 4C 24 3B 3A 8B 20 52 4F EF 0F 0E 20 CF 20 91 20 50 49 3B 00

1570 PRINTFNC$(RO,0x18);ID$;FNC$(RO,13);FAC$;
A4 8A 22 06 91 D3 43 24 28 52 4F 2C 18 29 3B 49 44 24 3B D3 43 24 28 52 4F 2C 0F 0D 29 3B 46 41 43 24 3B 00

1580 PRINTFNC$(RO,24);NM$;
B9 8A 2C 06 91 D3 43 24 28 52 4F 2C 0F 18 29 3B 4E 4D 24 3B 00

1590 RETURN
BF 8A 36 06 8E 00

1600 :REM distance
CF 8A 40 06 3A 8F DB 64 69 73 74 61 6E 63 65 00

1610 A=P1-P3
DB 8A 4A 06 41 F0 50 31 F3 50 33 00

1620 B1=P2-P4
E8 8A 54 06 42 31 F0 50 32 F3 50 34 00

1630 P=COS(P2/U)*COS(P4/U)
00 8B 5E 06 50 F0 FF 8C 28 50 32 F5 55 29 F4 FF 8C 28 50 34 F5 55 29 00

1640 Q=P*COS(ABS(A)/U)+COS(ABS(B1)/U)-P:IF Q<=0x11 THEN PRINT BL$:GOTO 1830
38 8B 68 06 51 F0 50 F4 FF 8C 28 FF 86 28 41 29 F5 55 29 F2 FF 8C 28 FF 86 28 42 31 29 F5 55 29 F3 50 3A 8B 20 51 F1 F0 11 20 CF 20 91 20 42 4C 24 3A 89 20 0E 26 07 00

1650 Q2=ATN(SQR(0x12-Q*Q)/Q):Q=Q2*U*60
59 8B 72 06 51 32 F0 FF 8E 28 FF 87 28 12 F3 51 F4 51 29 F5 51 29 3A 51 F0 51 32 F4 55 F4 0F 3C 00

1660 C=FNS6(Q):IF C>900 AND ABS(A)>30 THEN PRINT BL$:GOTO1840
86 8B 7C 06 43 F0 D3 53 36 28 51 29 3A 8B 20 43 EF 1C 84 03 20 F7 20 FF 86 28 41 29 EF 0F 1E 20 CF 20 91 20 42 4C 24 3A 89 0E 30 07 00

1670 IF C=0x11 THEN T=0x11:GOTO1780
9B 8B 86 06 8B 20 43 F0 11 20 CF 20 54 F0 11 3A 89 0E F4 06 00

1680 :REM true course
AE 8B 90 06 3A 8F DB 74 72 75 65 20 63 6F 75 72 73 65 00

1690 S=FNS8((P2+P4)/0x13):IF S>=0x12 THEN S=90-S:GOTO 1710
D9 8B 9A 06 53 F0 D3 53 38 28 28 50 32 F2 50 34 29 F5 13 29 3A 8B 20 53 EF F0 12 20 CF 20 53 F0 0F 5A F3 53 3A 89 20 0E AE 06 00

1700 S=FNS7(S)
E6 8B A4 06 53 F0 D3 53 37 28 53 29 00

1710 IF A>0x11 AND B1=0x11 THEN T=90:GOTO 1770
04 8C AE 06 8B 20 41 EF 11 20 F7 20 42 31 F0 11 20 CF 20 54 F0 0F 5A 3A 89 20 0E EA 06 00

1720 IF A<0x11 AND B1=0x11 THEN T=270:GOTO 1770
23 8C B8 06 8B 20 41 F1 11 20 F7 20 42 31 F0 11 20 CF 20 54 F0 1C 0E 01 3A 89 20 0E EA 06 00

1730 IF A>0x11 AND B1<0x11 THEN T=S:GOTO 1770
40 8C C2 06 8B 20 41 EF 11 20 F7 20 42 31 F1 11 20 CF 20 54 F0 53 3A 89 20 0E EA 06 00

1740 IF A>=0x11 AND B1>0x11 THEN T=180-S:GOTO 1770
61 8C CC 06 8B 20 41 EF F0 11 20 F7 20 42 31 EF 11 20 CF 20 54 F0 0F B4 F3 53 3A 89 20 0E EA 06 00

1750 IF A<0x11 AND B1>0x11 THEN T=180+S:GOTO 1770
81 8C D6 06 8B 20 41 F1 11 20 F7 20 42 31 EF 11 20 CF 20 54 F0 0F B4 F2 53 3A 89 20 0E EA 06 00

1760 T=360-S
8D 8C E0 06 54 F0 1C 68 01 F3 53 00

1770 T=FNS6(T)
9A 8C EA 06 54 F0 D3 53 36 28 54 29 00

1780 RETURN
A0 8C F4 06 8E 00

1790 :REM map lc
AE 8C FE 06 3A 8F DB 6D 61 70 20 6C 63 00

1800 FOR L=0x12 TO LEN(X$):U$=MID$(X$,L,0x12)
CF 8C 08 07 82 20 4C F0 12 20 CE 20 FF 92 28 58 24 29 3A 55 24 F0 FF 83 28 58 24 2C 4C 2C 12 29 00

1810 IF ASC(U$)>96 AND ASC(U$)<123 THEN MID$(X$,L,0x12)=CHR$(ASC(U$)-32)
06 8D 12 07 8B 20 FF 95 28 55 24 29 EF 0F 60 20 F7 20 FF 95 28 55 24 29 F1 0F 7B 20 CF 20 FF 83 28 58 24 2C 4C 2C 12 29 F0 FF 96 28 FF 95 28 55 24 29 F3 0F 20 29 00

1820 NEXT L:RETURN
10 8D 1C 07 83 20 4C 3A 8E 00

1830 PRINTFNC$(MC+0x17,0x12);E$+"y4";BL$;"Distance excessive...":PRINT"Hit <RETURN> to continue...";:X$=INPUT$(0x12):GOTO10
73 8D 26 07 91 D3 43 24 28 4D 43 F2 17 2C 12 29 3B 45 24 F2 22 79 34 22 3B 42 4C 24 3B 22 44 69 73 74 61 6E 63 65 20 65 78 63 65 73 73 69 76 65 2E 2E 2E 22 3A 91 22 48 69 74 20 3C 52 45 54 55 52 4E 3E 20 74 6F 20 63 6F 6E 74 69 6E 75 65 2E 2E 2E 22 3B 3A 58 24 F0 85 24 28 12 29 3A 89 0E 0A 00 00

1840 PRINTFNC$(MC+0x17,0x12);E$+"y4";BL$;"Distance excessive."
A6 8D 30 07 91 D3 43 24 28 4D 43 F2 17 2C 12 29 3B 45 24 F2 22 79 34 22 3B 42 4C 24 3B 22 44 69 73 74 61 6E 63 65 20 65 78 63 65 73 73 69 76 65 2E 22 00

1850 PRINT"Possible course errors due to rhumb line.":PRINT"Hit <RETURN> to continue...";:X$=INPUT$(0x12):GOTO10
05 8E 3A 07 91 22 50 6F 73 73 69 62 6C 65 20 63 6F 75 72 73 65 20 65 72 72 6F 72 73 20 64 75 65 20 74 6F 20 72 68 75 6D 62 20 6C 69 6E 65 2E 22 3A 91 22 48 69 74 20 3C 52 45 54 55 52 4E 3E 20 74 6F 20 63 6F 6E 74 69 6E 75 65 2E 2E 2E 22 3B 3A 58 24 F0 85 24 28 12 29 3A 89 0E 0A 00 00

1860 :REM condense
15 8E 44 07 3A 8F DB 63 6F 6E 64 65 6E 73 65 00

1870 IF MV>90 THEN 1970
27 8E 4E 07 8B 20 4D 56 EF 0F 5A 20 CF 20 0E B2 07 00

1880 PRINTFNC$(0x12,0x12);"Condensing files":PRINTMD
4C 8E 58 07 91 D3 43 24 28 12 2C 12 29 3B 22 43 6F 6E 64 65 6E 73 69 6E 67 20 66 69 6C 65 73 22 3A 91 4D 44 00

1890 NW=NW+0x12:OS=0x11:FOR J=0x12 TO MD
68 8E 62 07 4E 57 F0 4E 57 F2 12 3A 4F 53 F0 11 3A 82 20 4A F0 12 20 CE 20 4D 44 00

1900 IF PR(J)<0x14 THEN 1960
7C 8E 6C 07 8B 20 50 52 28 4A 29 F1 14 20 CF 20 0E A8 07 00

1910 IF PR(J)=0x14 THEN OS=OS+0x12:PRINTFNC$(0x13,0x12);MD-OS;L$
A7 8E 76 07 8B 20 50 52 28 4A 29 F0 14 20 CF 20 4F 53 F0 4F 53 F2 12 3A 91 D3 43 24 28 13 2C 12 29 3B 4D 44 F3 4F 53 3B 4C 24 00

1920 IF J+OS>MD THEN J=MD+0x12:GOTO1960
C3 8E 80 07 8B 20 4A F2 4F 53 EF 4D 44 20 CF 20 4A F0 4D 44 F2 12 3A 89 0E A8 07 00

1930 ID$(J)=ID$(J+OS):FA$(J)=FA$(J+OS):LT(J)=LT(J+OS):LN(J)=LN(J+OS):PR(J)=PR(J+OS):PR(J+OS)=0x15
21 8F 8A 07 49 44 24 28 4A 29 F0 49 44 24 28 4A F2 4F 53 29 3A 46 41 24 28 4A 29 F0 46 41 24 28 4A F2 4F 53 29 3A 4C 54 28 4A 29 F0 4C 54 28 4A F2 4F 53 29 3A 4C 4E 28 4A 29 F0 4C 4E 28 4A F2 4F 53 29 3A 50 52 28 4A 29 F0 50 52 28 4A F2 4F 53 29 3A 50 52 28 4A F2 4F 53 29 F0 15 00

1940 FOR K=0x12 TO MC:IF J+OS=W(K) THEN W(K)=J
45 8F 94 07 82 20 4B F0 12 20 CE 20 4D 43 3A 8B 20 4A F2 4F 53 F0 57 28 4B 29 20 CF 20 57 28 4B 29 F0 4A 00

1950 NEXT K:GOTO1900
52 8F 9E 07 83 20 4B 3A 89 0E 6C 07 00

1960 NEXT J:MD=MD-OS:PRINTFNC$(0x12,0x12);SPACE$(16):PRINTL$
78 8F A8 07 83 20 4A 3A 4D 44 F0 4D 44 F3 4F 53 3A 91 D3 43 24 28 12 2C 12 29 3B FF 98 28 0F 10 29 3A 91 4C 24 00

1970 RETURN
7E 8F B2 07 8E 00

