10 :REM  RNAVREF.BAS\tNAVPROGseven RNAV Cross-Reference Program     30-Dec-81
A3 6F 0A 00 3A 8F DB 20 52 4E 41 56 52 45 46 2E 42 41 53 09 4E 41 56 50 52 4F 47 73 65 76 65 6E 20 52 4E 41 56 20 43 72 6F 73 73 2D 52 65 66 65 72 65 6E 63 65 20 50 72 6F 67 72 61 6D 20 20 20 20 20 33 30 2D 44 65 63 2D 38 31 00

20 :REM 
AB 6F 14 00 3A 8F DB 00

30 :REM  Developed by\tAlan Bose   (AOPA 642188)
DA 6F 1E 00 3A 8F DB 20 44 65 76 65 6C 6F 70 65 64 20 62 79 09 41 6C 61 6E 20 42 6F 73 65 20 20 20 28 41 4F 50 41 20 36 34 32 31 38 38 29 00

40 :REM \t\t\tVice President, Taildragger Flyers
07 70 28 00 3A 8F DB 09 09 09 56 69 63 65 20 50 72 65 73 69 64 65 6E 74 2C 20 54 61 69 6C 64 72 61 67 67 65 72 20 46 6C 79 65 72 73 00

50 :REM \t\t\tRoss Field, Benton Harbor, MI
2F 70 32 00 3A 8F DB 09 09 09 52 6F 73 73 20 46 69 65 6C 64 2C 20 42 65 6E 74 6F 6E 20 48 61 72 62 6F 72 2C 20 4D 49 00

60 :REM 
37 70 3C 00 3A 8F DB 00

70 CLEAR 1000:ON ERROR GOTO 920:WIDTH 255
50 70 46 00 92 20 1C E8 03 3A 95 20 A8 20 89 20 0E 98 03 3A A1 20 0F FF 00

80 BL$=CHR$(0x18):E$=CHR$(27):ER$=E$+"E":U=[1F]184F3DD2STEP.eDIM
7F 70 50 00 42 4C 24 F0 FF 96 28 18 29 3A 45 24 F0 FF 96 28 0F 1B 29 3A 45 52 24 F0 45 24 F2 22 45 22 3A 55 F0 1F 18 4F 3D D2 E0 2E 65 86 00

90 PRINT"Checking RNAV references...";
A3 70 5A 00 91 22 43 68 65 63 6B 69 6E 67 20 52 4E 41 56 20 72 65 66 65 72 65 6E 63 65 73 2E 2E 2E 22 3B 00

100 DEF FNS5(X)=SIN(X/U):DEF FNS6(X)=INT(X*10+[1D]00000080)/10
D3 70 64 00 98 20 D3 53 35 28 58 29 F0 FF 89 28 58 F5 55 29 3A 98 20 D3 53 36 28 58 29 F0 FF 85 28 58 F4 0F 0A F2 1D 00 00 00 80 29 F5 0F 0A 00

110 DEF FNS7(X)=ATN(X/SQR(0x12-X*X))*U
F2 70 6E 00 98 20 D3 53 37 28 58 29 F0 FF 8E 28 58 F5 FF 87 28 12 F3 58 F4 58 29 29 F4 55 00

120 DEF FNS8(X)=SIN(ABS(A/0x13)/U)*COS(X/U)/SIN(Q2/0x13)
1E 71 78 00 98 20 D3 53 38 28 58 29 F0 FF 89 28 FF 86 28 41 F5 13 29 F5 55 29 F4 FF 8C 28 58 F5 55 29 F5 FF 89 28 51 32 F5 13 29 00

130 :REM 
26 71 82 00 3A 8F DB 00

140 OPEN"I",0x12,"SY1:FLIGHT.SEQ"
42 71 8C 00 BF 22 49 22 2C 12 2C 22 53 59 31 3A 46 4C 49 47 48 54 2E 53 45 51 22 00

150 FOR I=0x12 TO 10:LINE INPUT#0x12,P$(I)
5D 71 96 00 82 20 49 F0 12 20 CE 20 0F 0A 3A B1 20 85 23 12 2C 50 24 28 49 29 00

160 INPUT#0x12,R(I)
6A 71 A0 00 85 23 12 2C 52 28 49 29 00

170 N=I
72 71 AA 00 4E F0 49 00

180 NEXT I:CLOSE
7C 71 B4 00 83 20 49 3A C3 00

190 :REM 
84 71 BE 00 3A 8F DB 00

200 OPEN"I",0x12,"SY1:RNAVLIST.DAT"
A2 71 C8 00 BF 22 49 22 2C 12 2C 22 53 59 31 3A 52 4E 41 56 4C 49 53 54 2E 44 41 54 22 00

210 INPUT#0x12,KY
AD 71 D2 00 85 23 12 2C 4B 59 00

220 DIM LI$(KY),R1$(KY),R1(KY),R2$(KY),R2(KY)
D9 71 DC 00 86 20 4C 49 24 28 4B 59 29 2C 52 31 24 28 4B 59 29 2C 52 31 28 4B 59 29 2C 52 32 24 28 4B 59 29 2C 52 32 28 4B 59 29 00

230 FOR J=0x12 TO KY:LINE INPUT#0x12,LI$(J)
F5 71 E6 00 82 20 4A F0 12 20 CE 20 4B 59 3A B1 20 85 23 12 2C 4C 49 24 28 4A 29 00

240 LINE INPUT#0x12,R1$(J)
06 72 F0 00 B1 20 85 23 12 2C 52 31 24 28 4A 29 00

250 INPUT#0x12,R1(J)
14 72 FA 00 85 23 12 2C 52 31 28 4A 29 00

260 LINE INPUT#0x12,R2$(J)
25 72 04 01 B1 20 85 23 12 2C 52 32 24 28 4A 29 00

270 INPUT#0x12,R2(J)
33 72 0E 01 85 23 12 2C 52 32 28 4A 29 00

280 NEXT J:CLOSE
3D 72 18 01 83 20 4A 3A C3 00

290 :REM 
45 72 22 01 3A 8F DB 00

300 FOR I=0x12 TO N
53 72 2C 01 82 20 49 F0 12 20 CE 20 4E 00

310 FOR J=0x12 TO KY
62 72 36 01 82 20 4A F0 12 20 CE 20 4B 59 00

320 IF P$(I)<>LI$(J) THEN 460 :ELSE CP=0x12
84 72 40 01 8B 20 50 24 28 49 29 F1 EF 4C 49 24 28 4A 29 20 CF 20 0E CC 01 20 3A A2 20 43 50 F0 12 00

330 PI=R(I):K=0x11
94 72 4A 01 50 49 F0 52 28 49 29 3A 4B F0 11 00

340 GOSUB 510
9E 72 54 01 8D 20 0E FE 01 00

350 PI=R1(J):K=0x12
AF 72 5E 01 50 49 F0 52 31 28 4A 29 3A 4B F0 12 00

360 GOSUB 510
B9 72 68 01 8D 20 0E FE 01 00

370 IF R1$(J)="" THEN 390
CF 72 72 01 8B 20 52 31 24 28 4A 29 F0 22 22 20 CF 20 0E 86 01 00

380 L=0x12:M=0x11:GOSUB 620
E1 72 7C 01 4C F0 12 3A 4D F0 11 3A 8D 20 0E 6C 02 00

390 IF R2$(J)="" THEN 460
F7 72 86 01 8B 20 52 32 24 28 4A 29 F0 22 22 20 CF 20 0E CC 01 00

400 PI=R2(J):K=0x13
08 73 90 01 50 49 F0 52 32 28 4A 29 3A 4B F0 13 00

410 GOSUB 510
12 73 9A 01 8D 20 0E FE 01 00

420 IF R2$(J)="" THEN 460
28 73 A4 01 8B 20 52 32 24 28 4A 29 F0 22 22 20 CF 20 0E CC 01 00

430 L=0x13:M=0x11:GOSUB 620
3A 73 AE 01 4C F0 13 3A 4D F0 11 3A 8D 20 0E 6C 02 00

440 IF R1$(J)="" OR R2$(J)="" THEN 460
5C 73 B8 01 8B 20 52 31 24 28 4A 29 F0 22 22 20 F8 20 52 32 24 28 4A 29 F0 22 22 20 CF 20 0E CC 01 00

450 L=0x12:M=0x13:GOSUB620
6D 73 C2 01 4C F0 12 3A 4D F0 13 3A 8D 0E 6C 02 00

460 CP=0x11:NEXT J
7A 73 CC 01 43 50 F0 11 3A 83 20 4A 00

470 NEXT I
82 73 D6 01 83 20 49 00

480 CLOSE:KILL"SY1:FLIGHT.SEQ"
9A 73 E0 01 C3 3A C8 22 53 59 31 3A 46 4C 49 47 48 54 2E 53 45 51 22 00

490 LOAD"MENU",R
A8 73 EA 01 C4 22 4D 45 4E 55 22 2C 52 00

500 :REM 
B0 73 F4 01 3A 8F DB 00

510 IF DE=0x11 THEN OPEN"R",0x12,"SY1:AIRPORTS.RND":DE=0x12
DC 73 FE 01 8B 20 44 45 F0 11 20 CF 20 BF 22 52 22 2C 12 2C 22 53 59 31 3A 41 49 52 50 4F 52 54 53 2E 52 4E 44 22 3A 44 45 F0 12 00

520 REC=(PIMOD0x16)+0x12:SS=PI [FC] 0x16
F7 73 08 02 52 45 43 F0 28 50 49 FD 16 29 F2 12 3A 53 53 F0 50 49 20 FC 20 16 00

530 GET #0x12,REC
04 74 12 02 C1 20 23 12 2C 52 45 43 00

540 :REM decode
12 74 1C 02 3A 8F DB 64 65 63 6F 64 65 00

550 OPTION #0x12,SS*50 AS DU$,0x16 AS ID$,0x13 AS FAC$,0x15 AS FR$,20 AS NM$,0x13 AS D1$,0x15 AS M1$,0x13 AS D$,0x15 AS M$,0x15 AS V$,0x12 AS V1$,0x13 AS EL$
8A 74 26 02 C0 20 23 12 2C 53 53 F4 0F 32 20 41 53 20 44 55 24 2C 16 20 41 53 20 49 44 24 2C 13 20 41 53 20 46 41 43 24 2C 15 20 41 53 20 46 52 24 2C 0F 14 20 41 53 20 4E 4D 24 2C 13 20 41 53 20 44 31 24 2C 15 20 41 53 20 4D 31 24 2C 13 20 41 53 20 44 24 2C 15 20 41 53 20 4D 24 2C 15 20 41 53 20 56 24 2C 12 20 41 53 20 56 31 24 2C 13 20 41 53 20 45 4C 24 00

560 F5=CVI(FR$):D6=[0xFF][AA](D1$):M6=CVI(M1$):D5=[0xFF][AA](D$):M5=CVI(M$):V5=CVI(V$):E5=[0xFF][AA](EL$)
D8 74 30 02 46 35 F0 FF AB 28 46 52 24 29 3A 44 36 F0 FF AA 28 44 31 24 29 3A 4D 36 F0 FF AB 28 4D 31 24 29 3A 44 35 F0 FF AA 28 44 24 29 3A 4D 35 F0 FF AB 28 4D 24 29 3A 56 35 F0 FF AB 28 56 24 29 3A 45 35 F0 FF AA 28 45 4C 24 29 00

570 I$(K)=ID$:FC$(K)=FAC$:FR(K)=F5:NM$(K)=NM$
06 75 3A 02 49 24 28 4B 29 F0 49 44 24 3A 46 43 24 28 4B 29 F0 46 41 43 24 3A 46 52 28 4B 29 F0 46 35 3A 4E 4D 24 28 4B 29 F0 4E 4D 24 00

580 M1=M6/60:P2(K)=D6+M1
1F 75 44 02 4D 31 F0 4D 36 F5 0F 3C 3A 50 32 28 4B 29 F0 44 36 F2 4D 31 00

590 M=M5/60:P1(K)=D5+M
36 75 4E 02 4D F0 4D 35 F5 0F 3C 3A 50 31 28 4B 29 F0 44 35 F2 4D 00

600 V(K)=V5:V$(K)=V1$:EL(K)=E5:GOTO610
5A 75 58 02 56 28 4B 29 F0 56 35 3A 56 24 28 4B 29 F0 56 31 24 3A 45 4C 28 4B 29 F0 45 35 3A 89 0E 62 02 00

610 RETURN
60 75 62 02 8E 00

620 :REM distance
70 75 6C 02 3A 8F DB 64 69 73 74 61 6E 63 65 00

630 A=P1(L)-P1(M)
82 75 76 02 41 F0 50 31 28 4C 29 F3 50 31 28 4D 29 00

640 B1=P2(L)-P2(M)
95 75 80 02 42 31 F0 50 32 28 4C 29 F3 50 32 28 4D 29 00

650 P=COS(P2(L)/U)*COS(P2(M)/U)
B3 75 8A 02 50 F0 FF 8C 28 50 32 28 4C 29 F5 55 29 F4 FF 8C 28 50 32 28 4D 29 F5 55 29 00

660 Q=P*COS(ABS(A)/U)+COS(ABS(B1)/U)-P
D6 75 94 02 51 F0 50 F4 FF 8C 28 FF 86 28 41 29 F5 55 29 F2 FF 8C 28 FF 86 28 42 31 29 F5 55 29 F3 50 00

670 Q2=ATN(SQR(0x12-Q*Q)/Q):Q=Q2*U*60
F7 75 9E 02 51 32 F0 FF 8E 28 FF 87 28 12 F3 51 F4 51 29 F5 51 29 3A 51 F0 51 32 F4 55 F4 0F 3C 00

680 C=FNS6(Q)
04 76 A8 02 43 F0 D3 53 36 28 51 29 00

690 IF C=0x11 THEN T=0x11:Y=0x11:R=0x11:GOTO 910
22 76 B2 02 8B 20 43 F0 11 20 CF 20 54 F0 11 3A 59 F0 11 3A 52 F0 11 3A 89 20 0E 8E 03 00

700 :REM true bearing
36 76 BC 02 3A 8F DB 74 72 75 65 20 62 65 61 72 69 6E 67 00

710 S=FNS8((P2(L)+P2(M))/0x13):IF S>=0x12 THEN S=90-S:GOTO 730
67 76 C6 02 53 F0 D3 53 38 28 28 50 32 28 4C 29 F2 50 32 28 4D 29 29 F5 13 29 3A 8B 20 53 EF F0 12 20 CF 20 53 F0 0F 5A F3 53 3A 89 20 0E DA 02 00

720 S=FNS7(S)
74 76 D0 02 53 F0 D3 53 37 28 53 29 00

730 IF A>0x11 AND B1=0x11 THEN T=90:GOTO 790
92 76 DA 02 8B 20 41 EF 11 20 F7 20 42 31 F0 11 20 CF 20 54 F0 0F 5A 3A 89 20 0E 16 03 00

740 IF A<0x11 AND B1=0x11 THEN T=270:GOTO 790
B1 76 E4 02 8B 20 41 F1 11 20 F7 20 42 31 F0 11 20 CF 20 54 F0 1C 0E 01 3A 89 20 0E 16 03 00

750 IF A>0x11 AND B1<0x11 THEN T=S:GOTO 790
CE 76 EE 02 8B 20 41 EF 11 20 F7 20 42 31 F1 11 20 CF 20 54 F0 53 3A 89 20 0E 16 03 00

760 IF A>=0x11 AND B1>0x11 THEN T=180-S:GOTO 790
EF 76 F8 02 8B 20 41 EF F0 11 20 F7 20 42 31 EF 11 20 CF 20 54 F0 0F B4 F3 53 3A 89 20 0E 16 03 00

770 IF A<0x11 AND B1>0x11 THEN T=180+S:GOTO 790
0F 77 02 03 8B 20 41 F1 11 20 F7 20 42 31 EF 11 20 CF 20 54 F0 0F B4 F2 53 3A 89 20 0E 16 03 00

780 T=360-S
1B 77 0C 03 54 F0 1C 68 01 F3 53 00

790 T=FNS6(T)
28 77 16 03 54 F0 D3 53 36 28 54 29 00

800 :REM magnetic bearing
40 77 20 03 3A 8F DB 6D 61 67 6E 65 74 69 63 20 62 65 61 72 69 6E 67 00

810 V1=(V(L)+V(M))/0x13
55 77 2A 03 56 31 F0 28 56 28 4C 29 F2 56 28 4D 29 29 F5 13 00

820 V2=FNS6(V1)
64 77 34 03 56 32 F0 D3 53 36 28 56 31 29 00

830 Y=T+V2
6F 77 3E 03 59 F0 54 F2 56 32 00

840 IF Y<0x11 THEN Y=360-Y
83 77 48 03 8B 20 59 F1 11 20 CF 20 59 F0 1C 68 01 F3 59 00

850 IF Y>360 THEN Y=Y-360
99 77 52 03 8B 20 59 EF 1C 68 01 20 CF 20 59 F0 59 F3 1C 68 01 00

860 :REM print
A6 77 5C 03 3A 8F DB 70 72 69 6E 74 00

870 IF PT=0x11 THEN OPEN"O",0x13,"LP:":PT=0x12
C5 77 66 03 8B 20 50 54 F0 11 20 CF 20 BF 22 4F 22 2C 13 2C 22 4C 50 3A 22 3A 50 54 F0 12 00

880 IF CP=0x12 THEN PRINT#0x13,:PRINT#0x13,"RNAV bearings for ";I$(0x11);" ";NM$(0x11):CP=0x11
06 78 70 03 8B 20 43 50 F0 12 20 CF 20 91 23 13 2C 3A 91 23 13 2C 22 52 4E 41 56 20 62 65 61 72 69 6E 67 73 20 66 6F 72 20 22 3B 49 24 28 11 29 3B 22 20 22 3B 4E 4D 24 28 11 29 3A 43 50 F0 11 00

890 IF M=0x11 THEN PRINT#0x13,"NAV";L;": ";I$(L);FR(L);C;"nm ";Y;"deg Mag (";T;"True )"
50 78 7A 03 8B 20 4D F0 11 20 CF 20 91 23 13 2C 22 4E 41 56 22 3B 4C 3B 22 3A 20 22 3B 49 24 28 4C 29 3B 46 52 28 4C 29 3B 43 3B 22 6E 6D 20 22 3B 59 3B 22 64 65 67 20 4D 61 67 20 28 22 3B 54 3B 22 54 72 75 65 20 29 22 00

900 IF M=0x13 THEN PRINT#0x13,"NAV 1 to NAV 2 : ";C;"nm ";Y;"deg Mag (";T;"True )"
95 78 84 03 8B 20 4D F0 13 20 CF 20 91 23 13 2C 22 4E 41 56 20 31 20 74 6F 20 4E 41 56 20 32 20 3A 20 22 3B 43 3B 22 6E 6D 20 22 3B 59 3B 22 64 65 67 20 4D 61 67 20 28 22 3B 54 3B 22 54 72 75 65 20 29 22 00

910 RETURN
9B 78 8E 03 8E 00

920 :REM error trap
AD 78 98 03 3A 8F DB 65 72 72 6F 72 20 74 72 61 70 00

930 IF ERL=140 AND ERR=53 THEN RESUME 480
C8 78 A2 03 8B 20 D6 F0 0E 8C 00 20 F7 20 D7 F0 0F 35 20 CF 20 A9 20 0E E0 01 00

940 IF ERL=150 AND ERR=63 THEN J=11:RESUME 180
E8 78 AC 03 8B 20 D6 F0 0E 96 00 20 F7 20 D7 F0 0F 3F 20 CF 20 4A F0 0F 0B 3A A9 20 0E B4 00 00

950 IF ERL=200 AND ERR=53 THEN RESUME 480
03 79 B6 03 8B 20 D6 F0 0E C8 00 20 F7 20 D7 F0 0F 35 20 CF 20 A9 20 0E E0 01 00

960 IF ERL=480 AND ERR=53 THEN RESUME NEXT
1C 79 C0 03 8B 20 D6 F0 0E E0 01 20 F7 20 D7 F0 0F 35 20 CF 20 A9 20 83 00

970 ON ERROR GOTO 0
2A 79 CA 03 95 20 A8 20 89 20 0E 00 00 00

