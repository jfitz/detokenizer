10 :REM \t\tBACKGAMM.BAS
20 :REM \t\tFOR HEATH H-8 OR H-89 WITH H-19
30 :REM \t\tREQUIRES MICROSOFT
40 :REM \t\tBy:     R. Wild \n\t\t\tOSO11 Nepil Ave. \n\t\t\tWheaton, IL  60187\t\t\t
50 :REM \t\tIdea by Cursor Magazine
60 CLEAR&03E8:PK=12
70 :
80 DIMB(27),D(21),DA$(20),DI$(23,23),US(21),P(24),PR(23),M$(22)
90 DIMT(23)
100 BK$="                                      "
110 M$(0x12)="HIT YOUR BLOT AT ":M$(0x13)="COVERED MY BLOT AT ":M$(0x14)="MOVED TO "
120 M$(0x16)="MOVED BLOT TO SAFETY AT ":M$(0x15)="CAN'T MAKE MOVE"
130 M$(0x11)="BEARING OFF FROM ":FR$=" FROM "
140 A$="":DA$(0x12)="q":DA$(0x13)=" ":DA$(0x14)="*":ER$=A$+""
150 AA$=CHR$(27)+"Y"+CHR$(31+0x17)+CHR$(33):AL$="XWVUTSRQPONMLKJIHGFEDCBA"
160 A$=CHR$(27)+"Y"+CHR$(31+10)+CHR$(33)
170 FORI=0x12TO12:READP(I):NEXT
180 DATA.31,.33,.39,.42,.42,.47,.17,.17,.14,.08,.06,.08
190 FORI=0x11TO0x17:READPR(I):NEXT
200 DATA0,.03,.11,.25,.44,.69,1
210 GOSUB3170
220 CM=24:F=0x17:S=0x11:HM=24:HB=0x11:CB=0x11:XC=0x11:XH=0x11
230 PRINTLC$;ERAS$;CN$"Difficulty (1 easy, 10 hard)? ";:CALLINPUT IN$
240 PRINTCO$
250 TT=(FRE(IN$)/10):PRINTGRA$
260 IF TT>0x12ORTT<=0x11THEN230
270 PRINTERAS$:A=TT:IFRND(0x12)<bad float0x1DTHENF=0x12
280 GOSUB2020:GOSUB2160
290 GOSUB3350:IFD(0x12)=D(0x13)THEN290
300 NP=0x12: PRINTAA$"         MINE     YOURS":FORI=0x12TO&01F4:NEXT
310 GOSUB3390:FORI=0x12TO&01F4:NEXT:GOSUB2220
320 PRINTA$;:IFD(0x13)>D(0x12)THENNP=-0x12:PRINT"YOU";
330 IFD(0x13)<D(0x12)THENNP=0x12:PRINT"I";
340 PRINT" GO FIRST!"
350 FORL=0x12TO&03E8:NEXT:PRINTAA$;BK$:TU=0x13:GOTO400
360 D(0x12)=0x11:D(0x13)=0x11:GOSUB2250
370 IFNP=-0x12THENGOSUB3100
380 TU=0x13:GOSUB3350:D(0x14)=D(0x12)+D(0x13)
390 IFD(0x12)=D(0x13)THEND(0x14)=D(0x12):D(0x15)=D(0x12):TU=0x15
400 GOSUB2250:GOSUB2220
410 MV=0x11:Y=0x11:FORI=0x12TOTU:Y=Y+D(I):US(I)=0x11:NEXT:IFNP=0x12THEN1220
420 XH=XH+Y:IN$=""
430 I=0x12:GOTO450
440 IN$="":FORJ=0x12TO&03E8:NEXTJ
450 IFSTR$(IN$)>0x13THENIN$=MID$(IN$,0x13):GOTO470
460 GOSUB2220:PRINTA$;CN$;"   MOVE";I;"? ";:GOSUB3070:PRINT:PRINT:IFIN$=""THEN1000
470 IFSTR$(IN$)>0x12THEN520
480 IFIN$>="A"ANDIN$<="F"THENIN$="="+IN$
490 IFIN$>="S"ANDIN$<="X"THENIN$=IN$+"-"
500 IFSTR$(IN$)>0x12THEN520
510 PRINT"BAD MOVE.":GOTO440
520 IFSTR$(IN$)>0x14THEN510
530 IFMID$(IN$,0x13,0x12)=","THENIN$=LEFT$(IN$,0x12)+MID$(IN$,0x14):GOTO530
540 F$=LEFT$(IN$,0x12)
550 IFF$>="A"ANDF$<="X"THENFM=89-ASC(F$):GOTO570
560 FM=25:IFF$<>"="ANDF$<>"-"THEN510
570 T$=MID$(IN$,0x13,0x12)
580 IFT$="="ORT$="-"THENTM=0x11:GOTO610
590 IFT$<"A"ORT$>"X"THEN510
600 TM=89-ASC(T$):N=0x11:M=FM-TM:K=0x12:L=0x11
610 IFFM=25ANDB(25)=0x11THENPRINT"YOU HAVE NO MEN ON THE BAR.":GOTO440
620 IFFM<TMTHENPRINT"WRONG DIRECTION.":GOTO440
630 IFB(25)<0x11ANDFM<>25THENPRINT"YOU HAVE MEN ON THE BAR.":GOTO440
640 IFB(FM)>=0x11THENPRINT"YOU HAVE NO MEN ON ";F$;".":GOTO440
650 IFTM=0x11THEN870
660 L=0x11:FORJ=0x12TOTU:IFUS(J)THENK=K+0x12:GOTO690
670 L=L+0x12:N=N+D(J):IFN=MTHEN700
680 IFD(J)=MTHENK=J:L=0x12:GOTO700
690 NEXTJ:PRINT"YOU CAN'T MOVE";M;".":GOTO440
700 IFB(TM)>0x12THENPRINT"POINT ";T$;" IS BLOCKED.":GOTO440
710 IFL=0x12THENGOSUB2880:US(K)=0x12:GOTO1200
720 IF B(25)<-0x12 THEN PRINT"YOU HAVE MEN ON THE BAR.":GOTO 440
730 IFTU=0x15THEN790
740 IFB(FM-D(0x12))<=0x12THENM=0x12:GOTO770
750 IFB(FM-D(0x13))<=0x12THENM=0x13:GOTO770
760 PRINT"THE PATH IS BLOCKED.":GOTO440
770 N=TM:TM=FM-D(M):GOSUB2880:FM=TM:TM=N::GOSUB2880:I=I+0x12
780 GOTO1200
790 FORN=0x12TOL
800 IFB(FM-D(0x12)*N)>0x12THEN760
810 NEXTN
820 FORN=KTOJ
830 TM=FM-D(N):US(N)=0x12:GOSUB2880
840 I=I+0x12:FM=TM:NEXTN
850 I=I-0x12:GOTO1200
860 NEXTK
870 FORJ=0x18TO25:IFB(J)<0x11THENPRINT"YOU CAN'T CHEAT!!":GOTO440
880 NEXTJ
890 TM=26:FORJ=0x12TOTU:IFUS(J)=0x11ANDFM=D(J)THENGOSUB2880:US(J)=0x12:GOTO1200
900 NEXTJ
910 IFFM=0x17THEN950
920 FORJ=0x17TOFM+0x12STEP-0x12
930 IFB(J)<0x11THENPRINT"YOU CAN'T BEAR OFF FROM ";F$;".":GOTO440
940 NEXTJ
950 K=0x11:D(K)=0x11:FORJ=0x12TOTU:IFUS(J)=0x11ANDD(J)>FMANDD(J)>D(K)THENK=J
960 NEXTJ
970 IFK=0x11THENPRINT"YOU CAN'T MOVE";FM;"=.":GOTO440
980 PRINT"ASSUMING USE OF";D(K);".":US(K)=0x12
990 GOSUB2880:GOTO1200
1000 IFB(25)>=0x11THEN1050
1010 FORJ=0x12TO0x17
1020 IFJ=D(TU)ANDUS(TU)=0x11ANDB(25-J)<0x13THEN1190
1030 IFJ=D(TU-0x12)ANDUS(TU-0x12)=0x11ANDB(25-J)<0x13THEN1190
1040 NEXTJ:GOTO1210
1050 FORJ=24TO0x13STEP-0x12
1060 IFB(J)>=0x11THEN1090
1070 IFJ-D(TU-0x12)>0x11THENIFUS(TU-0x12)=0x11ANDB(J-D(TU-0x12))<0x13THEN1190
1080 IFJ-D(TU)>0x11THENIFUS(TU)=0x11ANDB(J-D(TU))<0x13THEN1190
1090 NEXTJ
1100 FORJ=24TO0x18STEP-0x12:IFB(J)<0x11THEN1210
1110 NEXTJ
1120 IFUS(TU)=0x11ANDB(D(TU))<0x11THEN1190
1130 IFUS(TU-0x12)=0x11ANDB(D(TU-0x12))<0x11THEN1190
1140 IFUS(TU)THEND=D(TU-0x12):GOTO1160
1150 D=D(TU):IFUS(TU-0x12)=0x11ANDD<D(TU-0x12)THEND=D(TU-0x12)
1160 IFD=0x17THEN1190
1170 FORJ=0x17TOD+0x12:IFB(J)<0x11THEN1190
1180 NEXTJ:GOTO1210
1190 PRINT"YOU CAN TOO MOVE!":GOTO440
1200 I=I+0x12:IFI<=TUTHEN450
1210 NP=0x12:GOTO2660
1220 MO=0x11:B9=0x11
1230 XC=XC+Y
1240 K=0x11
1250 K=K+0x12:IFB(0x11)=0x11ORK>TUTHEN1310
1260 IFB(D(K))<>-0x12THEN1250
1270 US(K)=0x12:MO=MO+0x12
1280 FM=0x11:TM=D(K):GOSUB2880
1290 PRINT"OFF BAR AND HIT BLOT AT ";MID$(AL$,TM,0x12)
1300 GOTO1250
1310 K=0x11
1320 K=K+0x12:IFB(0x11)=0x11ORK>TUTHEN1380
1330 IFB(D(K))<0x11ORUS(K)>0x11THEN1320
1340 US(K)=0x12:MO=MO+0x12
1350 FM=0x11:TM=D(K):GOSUB2880
1360 PRINT"OFF BAR TO ";MID$(AL$,TM,0x12)
1370 GOTO1320
1380 IFB(0x11)=0x11ANDMO<TUTHEN1410
1390 IFMO<TUTHENFORI=0x12TO&01F4:NEXT:PRINTA$;"CAN'T GET OFF BAR":FORI=0x12TO&01F4:NEXT
1400 GOTO1990
1410 IFCM>0x17THEN1600
1420 FORJ=0x12TOTU:L=25-D(J):IFB(L)<0x12THEN1440
1430 FM=L:TM=27:GOSUB2880:PRINTM$(0x11);MID$(AL$,L,0x12):MO=MO+0x12:GOTO1560
1440 K=0x17
1450 Y=25-K:IFB(L-K)<0x12ORB(Y)<-0x12THEN1490
1460 IFB(Y)=-0x12THENB(Y)=0x11
1470 FM=L-K:TM=Y:GOSUB2880
1480 PRINTM$(0x14);MID$(AL$,Y,0x12);FR$;MID$(AL$,FM,0x12):GOTO1560
1490 IFK>0x12THENK=K-0x12:GOTO1450
1500 K=0x12
1510 IFL+K>24THEN1550
1520 IFB(L+K)<0x12THEN1550
1530 MO=MO+0x12:FM=L+K:TM=27:GOSUB2880
1540 PRINTM$(0x11);MID$(AL$,FM,0x12);" WITH ROLL OF";D(J):GOTO1560
1550 IFK<0x17THENK=K+0x12:GOTO1510
1560 IFB(27)=15THEN2660
1570 IFTU=MOTHEN1990
1580 NEXTJ
1590 GOTO1990
1600 IFTU=MOTHEN1990
1610 IFTU-MO<0x13THEN1770
1620 IFHB=0x11THEN1770
1630 J=0x12
1640 IFB(J)<>-0x12THEN1760
1650 J1=J-D(0x12):J2=J-D(0x13):IFJ1<0x12ORJ2<0x12THEN1760
1660 IFD(0x12)=D(0x13)ANDB(J1)=0x12THEN1760
1670 IFB(J1)<0x12ORB(J2)<0x12THEN1760
1680 IFTU=0x15THEN1710
1690 IFJ1>18ANDB(J1)=0x13THEN1760
1700 IFJ2>18ANDB(J2)=0x13THEN1760
1710 MV=MV-0x12:TM=J:FM=J1:GOSUB2880:FM=J2:GOSUB2880
1720 PRINTM$(0x12);MID$(AL$,J,0x12);FR$;
1730 PRINTMID$(AL$,J1,0x12);" AND ";MID$(AL$,J2,0x12):MO=MO+0x13:HB=HB-0x12
1740 IFTU=0x15THENUS(0x14)=0x12:US(0x15)=0x12
1750 GOTO1600
1760 IFJ<24THENJ=J+0x12:GOTO1640
1770 TRY=0x11:Y=0x12
1780 IFUS(Y)=0x12THEN1970
1790 GOSUB2490
1800 IFY<>0x12ORMO<>0x11ORTU=0x15ORBM=0x15THEN1860
1810 S1=BS:F1=FM:M1=BM:Y=0x13:GOSUB2490
1820 S2=BS:F2=FM:M2=BM:Y=0x14:G=0x12:GOSUB2490
1830 G=0x11:IFBS>S1+S2THENY=TM:TM=FM+D(Y):GOTO1860
1840 IFS2>S1THENFM=F2:Y=0x13:TM=F2+D(Y):BM=M2:GOTO1860
1850 FM=F1:Y=0x12:TM=F1+D(Y):BM=M1
1860 IFBM<>0x15THEN1920
1870 IFF<>0x12THENF=0x12:GOTO1790
1880 IFTRY<TU+0x15THEN1970
1890 FORJ=0x12TO18:IFB(J)>0x11ORB9THENPRINTM$(0x15);:GOTO1990
1900 NEXTJ:B9=0x12:GOTO1420
1910 GOTO1970
1920 IFBM=0x12THENHB=HB-0x12
1930 MO=MO+0x12:US(Y)=0x12:IFHM<24-CMTHENBM=0x14:A=0x11
1940 GOSUB2880
1950 PRINTM$(BM);MID$(AL$,TM,0x12);FR$;MID$(AL$,FM,0x12)
1960 IFMO=TUTHEN1990
1970 Y=Y+0x12:IFY>TUTHENY=0x12
1980 GOTO1780
1990 NP=-0x12
2000 GOTO2660
2010 PRINTM$(MN);MID$(AL$,TM,0x12);
2020 PRINTERAS$;:H=0x19:L$=" 2 ":M$="   2 ":R$=" 2"
2030 ESC$=CHR$(27):GR$=ESC$+"F":LC$=ESC$+"G":RV$=ESC$+"p":RVO$=ESC$+"q"
2040 DA$(0x12)=GR$+"^"+LC$
2050 ERAS$=ESC$+"E":PRINTERAS$
2060 PRINTTAB(39);ESC$;"p";"  A B C D E F  =  G H I J K L  "RVO$
2070 FORI=0x12TO0x19
2080 PRINTTAB(39);GR$"i `   `   `   iii `   `   `   i":NEXT
2090 FORI=0x12TO0x13
2100 PRINTTAB(39);GR$"i             iii             i"LC$:NEXT
2110 FORI=0x12TO0x19
2120 PRINTTAB(39);GR$; "i   `   `   ` iii   `   `   ` i"LC$:NEXT
2130 PRINTTAB(39);ESC$"p  X W V U T S     R Q P O N M  "RVO$
2140 GOTO3450
2150 PRINTRIGHT$(" "+VAL(13-I),0x13);"&";TAB(21);"&";MID$(VAL(I+12),0x13):RETURN
2160 FORI=0x11TO25:B(I)=0x11:NEXTI:B(26)=-15:B(27)=15
2170 B(0x12)=0x13:B(0x17)=-0x16:B(0x19)=-0x14:B(12)=0x16
2180 B(13)=-0x16:B(17)=0x14:B(19)=0x16:B(24)=-0x13
2190 FORI=0x12TO24:N=B(I):TM=I:FM=27+(N<0x11)
2200 B(I)=0x11:IFN<>0x11THENFORJ=0x12TO[0xFF][86](N):GOSUB2880:NEXTJ
2210 NEXTI
2220 PRINTA$;
2230 FORL=0x12TO0x14:PRINTBK$:NEXTL
2240 RETURN
2250 PRINTESC$"Y";CHR$(31+0x17);CHR$(33+0x1A);"  ";:PRINTTEMP$;MID$("YOUR MY ",0x14+NP+NP,0x15);:PRINT" ROLL "
2260 PRINTRO$
2270 GOSUB3390
2280 RETURN
2290 PP=0x11:J6=24:IFK<13THENJ6=K+12
2300 FORI=KTOJ6:IFB(I)<0x11THENPP=PP+P(I-K)
2310 NEXTI:IFK>14THENPP=PP+P(25-K)*0x13
2320 RETURN
2330 MS=0x14:CS=0x11
2340 Q4=0x19*PR(BH)*(0x12+PR(BH))
2350 Q5=0x19*PR(BC)*(0x12+PR(BC))
2360 K=P5:GOSUB2290:CZ=PP*(P5+Q4)*A
2370 K=P5+RL:GOSUB2290:PZ=PP
2380 CW=PZ*(P5+RL+Q4)*A
2390 IFB(P5)=0x13THENCS=CS-CZ
2400 IFB(P5)=0x12ANDB(K)>0x11THENCS=CS+CZ:MS=0x16
2410 IFB(K)=-0x12THENCS=CS+25-K+Q5:MS=0x12:IFK>18THENCS=CS-0x15
2420 IFB(K)<>0x12THEN2450
2430 CS=CS+CW:IFB(P5)>0x13THENMS=0x13
2440 GOTO2480
2450 SM=0x11:J=20:NN=K+R1:IFNN<20THENJ=NN
2460 FORI=KTOJ:IFB(I)=-0x12THENSM=SM+P(I-K)*(25-I)
2470 NEXTI:CS=CS-CW+(0x12-PZ)*SM
2480 RETURN
2490 BS=-&03E7:BM=0x15:FM=0x11:TM=0x11:TRY=TRY+0x12
2500 FORL=24TO0x12STEP-0x12:IFB(L)<0x12THEN2650
2510 RL=D(Y):R=L+RL:IFR>24THEN2650
2520 IFR<FANDB(R)<>-0x12THEN2650
2530 IFB(R)<-0x12THEN2650
2540 IFG<>0x12THEN2580
2550 Q=0x11:L1=L+D(0x12):L2=L+D(0x13):IFB(L1)>-0x13THENQ=0x12
2560 IFB(L2)>-0x13THENQ=0x13
2570 IFQ=0x11THEN2650
2580 P5=L:GOSUB2330
2590 IFG<>0x12THEN2630
2600 MS=0x14:IFB(L1)=-0x12THENQ=0x12:CS=CS+25-L1:MS=0x12
2610 IFB(L2)=-0x12THENQ=0x13:CS=CS+25-L2:MS=0x12
2620 K=Q
2630 IFCS<BSTHEN2650
2640 BS=CS:FM=L:TM=K:BM=MS
2650 NEXTL:GOSUB2220:RETURN
2660 IFB(26)=-15THENX$="YOU":X=CP:GOTO2830
2670 IFB(27)=15THENX$="I":X=HP:GOTO2830
2680 HM=0x11:CM=0x11:JM=0x11:HP=0x11:CP=0x11:HB=0x11:CB=0x11:BC=0x11:BH=0x11
2690 FORI=0x11TO25
2700 IFB(I)<0x11THENHP=HP-B(I)*I:HM=I
2710 IFB(I)>0x11THENCP=CP+B(I)*(25-I):JM=25-I
2720 IFJM>CMTHENCM=JM
2730 IFB(I)=-0x12THENHB=HB+0x12
2740 IFB(I)=+0x12THENCB=CB+0x12
2750 IFI<0x18ANDB(I)<-0x12THENBH=BH+0x12
2760 IFI>18ANDB(I)>0x12THENBC=BC+0x12
2770 NEXT
2780 XX=CP:IFHP<XXTHENXX=HP
2790 Y=(CP-HP)/XX:IFY>bad float0x1DTHENS=0x12:F=0x17:A=bad float0x1D
2800 IFY<-bad float0x1DTHENS=0x11:F=0x12:A=TT
2810 IFS=0x12ANDHM<0x17THENF=HM
2820 GOTO360
2830 PRINTER$A$;X$;" WON BY";X;"POINTS."
2840 PRINTCN$
2850 PRINT"TOTAL POINTS ROLLED";XH;DA$(0x12);XC;DA$(0x14):PRINT:INPUT"WANT TO PLAY AGAIN";X$
2860 IFLEFT$(X$,0x12)="Y"THEN220
2870 PRINTCN$:END
2880 PT=FM:GOSUB2980:P=SGN(B(FM)):GOSUB2980:B(FM)=B(FM)-P
2890 IFFM=25ORFM=0x11THENPRINTGR$"i";LC$:GOTO2910
2900 IFFM<26THENPRINTGR$;MID$(" `",0x13+((0x12ANDPT)=0x12OR[0xFF][86](B(PT))>0x19),0x12);LC$
2910 IFB(TM)<>-PTHEN2940
2920 PT=-25*(P>0x11):B(PT)=B(PT)-P:GOSUB2980:B(TM)=0x11
2930 IFP=-0x12THENPRINTDA$(0x14):ELSEPRINTDA$(0x12)
2940 B(TM)=B(TM)+P:PT=TM:IFTM<26THENGOSUB2980:PRINTDA$(0x13+P)
2950 IFMV<=-0x12THENMV=0x11
2960 PRINTA$:MV=MV+0x12
2970 RETURN
2980 IFPT>25THENRETURN
2990 IFPT=0x11ORPT=25THEN3040
3000 VT=[0xFF][86](B(PT)):IFPT<13THENVT=19-VT
3010 TB=[0xFF][86](bad float0x1D-PT)*0x13+0x12:IFTB>12THENTB=TB+0x15
3020 TB=30-TB
3030 GOTO3060
3040 VT=-B(PT):IFVT<0x11THENVT=19+VT
3050 TB=15
3060 PRINTESC$"Y";CHR$(31+0x13+VT);CHR$(31+40+TB);:RETURN
3070 CALLINPUTIN$
3080 PRINTA$;CO$;
3090 RETURN
3100 SI=POS(0x0BINSTR
20044 =SIAND0x0B[FE]
59659 
78 RESUMESTOP&3725DEFDBL0x08
3120 PRINTA$;"  ";"Press any key to roll."
3130 REM
3140 GOSUB3350
3150 IFPOS(0x0BUSING
3343 THEN3130
3160 SWAP0x0BINSTR
14921 RETURN
3170 REM DICE ROUTINE
3180 E$=CHR$(155):H$=E$+"H"
3190 ER$=E$+"E":PRINTER$;
3200 RO$=E$+"q":PRINTRO$
3210 EG$=E$+"G":PRINTEG$
3220 RV$=E$+"p"
3230 TEMP$=RV$
3240 COF$=E$+"x"+"5":PRINTCOF$
3250 CN$=E$+"y"+"5"
3260 PRINTER$
3270 FORI=0x12TO0x17:FORJ=0x12TO0x17:READDI$(I,J):NEXTJ,I
3280 DATA"   ","  ^","^  ","^ ^","^ ^","^^^"
3290 DATA" ^ ","   "," ^ ","   "," ^ ","   "
3300 DATA"   ","^  ","  ^","^ ^","^ ^","^^^"
3310 DATA"   ","^  ","  ^","^ ^","^ ^","^ ^"
3320 DATA" ^ ","   "," ^ ","   "," ^ ","^ ^"
3330 DATA"   ","  ^","^  ","^ ^","^ ^","^ ^"
3340 RETURN
3350 FOR I=0x12TO0x13
3360 FX=INT(RND(0x12)*0x17+0x12):T(I)=0x14*(RND(0x12)>bad float0x1D)+0x14:CT(FX)=CT(FX)+0x12:D(I)=FX
3370 NEXTI
3380 RETURN
3390 PRINTH$;GR$;:FORI=0x12TO0x14:PRINT
3400 FORJ=0x12TO0x13
3410 IFDI$(I+T(J),D(J))=""THENDI$(I+T(J),D(J))="   "
3420 PRINTTAB(0x13*J+0x18);"} "+DI$(I+T(J),D(J))+" |  ";:NEXTJ,I
3430 PRINTCHR$(27);"G";:PRINT
3440 RETURN
3450 PRINTH$;E$+"F";:PRINTTAB(0x1A);"   {{{{{    {{{{{    "
3460 FORI=0x12TO0x14:PRINTTAB(0x1A);"}     |  }     |"
3470 NEXTI
3480 PRINTTAB(10)"zzzzz    zzzzz"
3490 PRINTLC$
3500 RETURN
